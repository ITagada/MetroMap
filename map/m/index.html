<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="apple-touch-icon" sizes="180x180" href="/map/img/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/map/img/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/map/img/favicon-16x16.png">
    <link rel="manifest" href="/map/site.webmanifest">
    <link rel="mask-icon" href="/map/img/safari-pinned-tab.svg" color="#da322a">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="theme-color" content="#ffffff">
    <title>Схема МЦД</title>
    <link rel="stylesheet" href="/map/css/app.css?v8.0">
    <script src="/map/js/jquery.js"></script>
</head>
<body class="_map">

    <img id="preloadedImage" src="/map/new_map_black.png?v=23" style="display: none;">

    <div class="map">
        <div class="map__library">
            <img src="/map/slice.svg?v11.0" class="map__library-img">
        </div>

        <div class="map__viewport">
            <div class="map__viewport-in">
                <div class="map__layer" id="map-background"></div>
                <div class="map__layer" id="map-route">
                    <svg viewBox="0 0 2850 3449" src="/map/new_map.png?v=23" whith="200px"></svg>
                </div>
                <div class="map__layer" id="map-markers"  >
                    <svg viewBox="0 0 2850 3449" id="svgId" onclick="creale_mar()">
                        <use xlink:href="/map/slice.svg#line0_19"></use>
                    </svg>
                </div>
            </div>
        </div>
	    <div class="visually_impaired">
            <div id="check-color" class="mode_for_the_visually_impaired" ></div>
        </div>




        <div id="fixedDiv">
            <div class="left-buttons">
                <div class="content_image departureTextEdit-content-image" style="display: inline-block; margin-right: 10px;" id="departureImage"></div>
                <button class="content_text_station departureTextEdit-content btn" id="departureBtn">Отправление</button>
                <li class="swap_station" id="swap_station" style="display: inline-block; margin-right: 10px;"></li>
                <div class="content_image arrivalTextEdit-content-image" id="arrivalImage" style="display: inline-block; margin-right: 10px;"></div>
                <button class="content_text_station arrivalTextEdit-content btn" id="arrivalBtn">Прибытие на станцию</button>
                <div class="clear_routs" id="clear_routs" style="display: none;" onclick="creale()">Очистить</div>
                <div id="result"></div>

                </div>
                <div class="right-buttons">
                    <div class="hamburger" onclick="toggleMenu()">
                        &#9776; <!-- Иконка гамбургера -->
                    </div>
                    <span class="strip"></span>
                    <select id="languageSelector">
                        <option value="ru">RU</option>
                        <option value="en">EN</option>
                        <option value="cn">CN</option>
                        <option value="kz">KZ</option>
                    </select>
                </div>

            </div>

        </div>

        <div id="div_open">
            <div class="Going">
                <div class="pip new_class" id="pip"></div>
            </div>

            <div id="menu" class="menu">
                <ul class="img_position">
                    <li><img src="/map/img/1.webp" onclick="showLineStations(0)" id="i1" width="30px"></li>
                    <li><img src="/map/img/2.webp" onclick="showLineStations(1)" id="i2" width="30px"></li>
                    <li><img src="/map/img/3.webp" onclick="showLineStations(2)" id="i3" width="30px"></li>
                    <li><img src="/map/img/4.webp" onclick="showLineStations(3)" id="i4" width="30px"></li>
                    <li><img src="/map/img/5.webp" onclick="showLineStations(4)" id="i5" width="30px"></li>
                    <li><img src="/map/img/6.webp" onclick="showLineStations(5)" id="i6" width="30px"></li>
                    <li><img src="/map/img/7.webp" onclick="showLineStations(6)" id="i7" width="30px"></li>
                    <li><img src="/map/img/8.webp" onclick="showLineStations(7)" id="i8" width="30px"></li>
                    <li><img src="/map/img/8A.webp" onclick="showLineStations(8)" id="i8" width="30px"></li>
                    <li><img src="/map/img/9.webp" onclick="showLineStations(9)" id="i9" width="30px"></li>
                    <li><img src="/map/img/10.webp" onclick="showLineStations(10)" id="i10" width="30px"></li>
                    <li><img src="/map/img/11.webp" onclick="showLineStations(11)" id="i11" width="30px"></li>
                    <li><img src="/map/img/12.webp" onclick="showLineStations(12)" id="i12" width="30px"></li>
                    <li><img src="/map/img/13.webp" onclick="showLineStations(13)" id="i13" width="30px"></li>
                    <li><img src="/map/img/14.webp" onclick="showLineStations(14)" id="i12" width="30px"></li>
                    <li><img src="/map/img/15.webp" onclick="showLineStations(15)" id="i12" width="30px"></li>
                    <li><img src="/map/img/16.webp" onclick="showLineStations(16)" id="i12" width="30px"></li>
                    <li><img src="/map/img/D1.webp" onclick="showLineStations(17)" id="i13" width="30px"></li>
                    <li><img src="/map/img/D2.webp" onclick="showLineStations(18)" id="i13" width="30px"></li>
                    <li><img src="/map/img/D3.webp" onclick="showLineStations(19)" id="i13" width="30px"></li>
                    <li><img src="/map/img/D4.webp" onclick="showLineStations(20)" id="i13" width="30px"></li>
                </ul>
            </div>
            <div class="scroll-container" id="container">
                <ul id="Name_station"></ul>
            </div>
            <!-- Keyboard and other elements -->
            <div id="keyboard">
                <div class="keyboard-row">
                    <button class="key">Й</button>
                    <button class="key">Ц</button>
                    <button class="key">У</button>
                    <button class="key">К</button>
                    <button class="key">Е</button>
                    <button class="key">Н</button>
                    <button class="key">Г</button>
                    <button class="key">Ш</button>
                    <button class="key">Щ</button>
                    <button class="key">З</button>
                    <button class="key">Х</button>
                    <button class="key">Ъ</button>
                </div>
                <div class="keyboard-row">
                    <button class="key">Ф</button>
                    <button class="key">Ы</button>
                    <button class="key">В</button>
                    <button class="key">А</button>
                    <button class="key">П</button>
                    <button class="key">Р</button>
                    <button class="key">О</button>
                    <button class="key">Л</button>
                    <button class="key">Д</button>
                    <button class="key">Ж</button>
                    <button class="key">Э</button>
                </div>
                <div class="keyboard-row">
                    <button class="key">Я</button>
                    <button class="key">Ч</button>
                    <button class="key">С</button>
                    <button class="key">М</button>
                    <button class="key">И</button>
                    <button class="key">Т</button>
                    <button class="key">Ь</button>
                    <button class="key">Б</button>
                    <button class="key">Ю</button>
                    <button class="key" id="space">_</button>
                    <button class="key" id="backspace">⌫</button>
                </div>
            </div>
        </div>

        <div class="BlockStations"></div>
<script>
let currentLangIndex = 0;


const stations = {
    'Бульвар Рокоссовского': ["Бульвар Рокоссовского", "Rokossovsky Boulevard", "罗科索夫斯基布儿瓦尔", "Рокоссовский бульвары"],
    'Черкизовская': ["Черкизовская", "Cherkizovskaya", "切尔基佐夫斯卡娅", "Черкизовская"],
    'Преображенская площадь': ["Преображенская площадь", "Preobrazhenskaya Square", "普列欧勃拉任斯卡亚普洛夏基", "Преображенская алаңы"],
    'Сокольники': ["Сокольники", "Sokolniki", "索科利尼基", "Сокольники"],
    'Красносельская': ["Красносельская", "Krasnoselskaya", "克拉斯诺谢儿斯卡娅", "Красносельская"],
    'Комсомольская': ["Комсомольская", "Komsomolskaya", "科姆萨莫儿斯卡娅", "Комсомольская"],
    'Красные Ворота': ["Красные Ворота", "Red Gate", "卡拉斯内沃罗塔", "Красные Ворота"],
    'Чистые пруды': ["Чистые пруды", "Chistye Prudy", "斯特普鲁德/奇斯特耶普鲁德", "Чистые пруды"],
    'Лубянка': ["Лубянка", "Lubyanka", "奥霍特内利亚德", "Лубянка"],
    'Охотный Ряд': ["Охотный Ряд", "Okhotniy Row", "奥霍特内利亚德", "Охотный Ряд"],
    'Библиотека им. Ленина': ["Библиотека им. Ленина", "Lenin Library", "比勃利欧捷卡伊米妮 列宁纳", "Ленин атындағы кітапхана"],
    'Кропоткинская': ["Кропоткинская", "Kropotkinskaya", "克罗珀特肯斯卡亚", "Кропоткинская"],
    'Парк культуры': ["Парк культуры", "Park of Culture", "帕克库儿图尔", "Культура саябағы"],
    'Фрунзенская': ["Фрунзенская", "Frunzenskaya", "伏龙芝斯卡亚", "Фрунзенская"],
    'Спортивная': ["Спортивная", "Sportivnaya", "斯珀尔基夫纳亚", "Спортивная"],
    'Воробьёвы горы': ["Воробьёвы горы", "Vorobyovy Hills", "沃洛比约维格雷", "Воробьевы горы"],
    'Университет': ["Университет", "University", "乌尼维尔西捷特", "Университет"],
    'Проспект Вернадского': ["Проспект Вернадского", "Vernadsky Avenue", "普罗斯别克特维尔纳得斯科沃", "Вернадский даңғылы"],
    'Юго-Западная': ["Юго-Западная", "Southwestern", "由噶扎帕得纳亚", "Оңтүстік-Батыс"],
    'Тропарёво': ["Тропарёво", "Troparyovo", "特罗帕廖沃", "Тропарёво"],
    'Румянцево': ["Румянцево", "Rumyantsevo", "鲁缅采沃", "Румянцево"],
    'Саларьево': ["Саларьево", "Salaryevo", "莎拉里耶沃", "Саларьево"],
    'Филатов Луг': ["Филатов Луг", "Filatov Meadow", "菲拉托夫卢格", "Филатов Луг"],
    'Прокшино': ["Прокшино", "Prokshino", "普罗克希诺", "Прокшино"],
    'Ольховая': ["Ольховая", "Olkhovaya", "奥利霍瓦娅", "Ольховая"],
    'Новомосковская': ["Новомосковская", "Novomoskovskaya", "诺沃莫斯科夫斯卡娅", "Новомосковская"],
    'Потапово': ["Потапово", "Potapovo", "波塔波沃", "Потапово"],

    'Алма-Атинская': ["Алма-Атинская", "Alma-Atinskaya", "奥玛-阿丁斯卡娅", "Алматы"],
    'Красногвардейская': ["Красногвардейская", "Krasnogvardeyskaya", "克拉斯诺格瓦尔杰斯卡娅", "Красногвардейская"],
    'Домодедовская': ["Домодедовская", "Domodedovskaya", "多莫杰多夫斯ка娅", "Домодедовская"],
    'Орехово': ["Орехово", "Orekhovo", "奥列霍沃", "Орехово"],
    'Царицыно': ["Царицыно", "Tsaritsyno", "察里津诺", "Царицыно"],
    'Кантемировская': ["Кантемировская", "Kantemirovskaya", "坎捷米罗夫斯ка娅", "Кантемировская"],
    'Каширская': ["Каширская", "Kashirskaya", "卡什尔斯卡娅", "Каширская"],
    'Коломенская': ["Коломенская", "Kolomenskaya", "科洛缅斯卡娅/科罗缅斯卡娅", "Коломенская"],
    'Технопарк': ["Технопарк", "Technopark", "铁盒诺怕克", "Технопарк"],
    'Автозаводская': ["Автозаводская", "Avtozavodskaya", "阿夫托扎沃德期卡娅", "Автозаводская"],
    'Павелецкая': ["Павелецкая", "Paveletskaya", "珀维列茨卡亚", "Павелецкая"],
    'Новокузнецкая': ["Новокузнецкая", "Novokuznetskaya", "诺沃库兹涅茨卡娅", "Новокузнецкая"],
    'Театральная': ["Театральная", "Teatralnaya", "加特拉尔纳亚", "Театральная"],
    'Тверская': ["Тверская", "Tverskaya", "特维尔斯卡亚", "Тверская"],
    'Маяковская': ["Маяковская", "Mayakovskaya", "马雅可夫斯卡亚", "Маяковская"],
    'Белорусская': ["Белорусская", "Belorusskaya", "别拉鲁斯卡亚", "Белорусская"],
    'Динамо': ["Динамо", "Dinamo", "迪纳摩", "Динамо"],
    'Аэропорт': ["Аэропорт", "Airport", "阿艾罗珀尔特", "Әуежайы"],
    'Сокол': ["Сокол", "Falcon", "索科勒", "Сокол"],
    'Войковская': ["Войковская", "Voykovskaya", "沃依科夫斯卡亚", "Войковская"],
    'Водный стадион': ["Водный стадион", "Water Stadium", "沃德内斯塔爵", "Водный стадион"],
    'Речной вокзал': ["Речной вокзал", "River Station", "列奇诺沃克灶", "Речной вокзал"],
    'Беломорская': ["Беломорская", "Belomorskaya", "别罗莫斯卡娅", "Беломорская"],
    'Ховрино': ["Ховрино", "Khovrino", "霍夫利诺", "Ховрино"],

    'Пятницкое шоссе': ["Пятницкое шоссе", "Pyatnitskoe highway", "皮亚特尼茨科耶绍赛", "Пятницкое шоссе"],
    'Митино': ["Митино", "Mitino", "米金诺", "Митино"],
    'Волоколамская': ["Волоколамская", "Volokolamskaya", "沃洛科拉姆斯ка娅", "Волоколамская"],
    'Мякинино': ["Мякинино", "Myakinino", "米基宁诺", "Мякинино"],
    'Строгино': ["Строгино", "Strogino", "斯特罗基诺", "Строгино"],
    'Крылатское': ["Крылатское", "Krylatskoe", "克雷拉特斯科耶", "Крылатское"],
    'Молодёжная': ["Молодёжная", "Molodyozhnaya", "莫洛焦日纳亚", "Молодёжная"],
    'Кунцевская': ["Кунцевская", "Kuntsevskaya", "昆采沃斯卡娅", "Кунцевская"],
    'Славянский бульвар': ["Славянский бульвар", "Slavic Boulevard", "斯拉维扬斯基布儿瓦尔", "Славян бульвары"],
    'Парк Победы': ["Парк Победы", "Victory Park", "怕克珀别得", "Победа саябағы"],
    'Киевская': ["Киевская", "Kievskaya", "基辅斯卡娅", "Киевская"],
    'Смоленская': ["Смоленская", "Smolenskaya", "斯莫连斯卡娅", "Смоленская"],
    'Арбатская': ["Арбатская", "Arbatskaya", "阿尔巴特斯卡娅", "Арбатская"],
    'Площадь Революции': ["Площадь Революции", "Revolution Square", "普洛夏基列沃留茨", "Площадь Революции"],
    'Курская': ["Курская", "Kurskaya", "库尔斯ка娅", "Курская"],
    'Бауманская': ["Бауманская", "Baumanskaya", "鲍曼斯卡娅", "Бауманская"],
    'Электрозаводская': ["Электрозаводская", "Elektrozavodskaya", "艾列克特拉扎沃得斯卡娅", "Электрозаводская"],
    'Семёновская': ["Семёновская", "Semyonovskaya", "谢苗诺夫斯卡娅", "Семёновская"],
    'Партизанская': ["Партизанская", "Partizanskaya", "帕尔吉赞斯卡娅", "Партизанская"],
    'Измайлово': ["Измайлово", "Izmaylovskaya", "伊兹迈诺沃", "Измайлово"],
    'Первомайская': ["Первомайская", "Pervomayskaya", "别尔沃麦斯卡娅", "Первомайская"],
    'Щёлковская': ["Щёлковская", "Schyolkovskaya", "肖科夫斯卡娅", "Щёлковская"],

    'Александровский сад': ["Александровский сад", "Alexander Garden", "亚厉山大罗夫斯基萨德", "Александровский сад"],
    'Арбатская': ["Арбатская", "Arbatskaya", "阿尔巴特斯卡娅", "Арбатская"],
    'Смоленская': ["Смоленская", "Smolenskaya", "斯莫连斯卡娅", "Смоленская"],
    'Киевская': ["Киевская", "Kievskaya", "基辅斯卡娅", "Киевская"],
    'Деловой центр': ["Деловой центр", "Business center", "杰罗沃Й Центр", "Деловой центр"],
    'Москва-Сити': ["Москва-Сити", "Moscow-City", "莫斯科城", "Москва-Сити"],
    'Студенческая': ["Студенческая", "Studencheskaya", "斯图坚切斯卡娅", "Студенческая"],
    'Кутузовская': ["Кутузовская", "Kutuzovskaya", "库图佐夫斯卡娅", "Кутузовская"],
    'Фили': ["Фили", "Fili", "费利", "Фили"],
    'Багратионовская': ["Багратионовская", "Bagrationovskaya", "巴格拉吉欧诺夫斯卡娅", "Багратион саябағы"],
    'Филёвский парк': ["Филёвский парк", "Filyovskiy Park", "费廖夫斯基帕克", "Филёвский саябағы"],
    'Пионерская': ["Пионерская", "Pionerskaya", "皮欧涅耳斯卡娅", "Пионерская"],
    'Кунцевская': ["Кунцевская", "Kuntsevskaya", "昆采沃斯卡娅", "Кунцевская"],

    'Комсомольская': ["Комсомольская", "Komsomolskaya", "科姆萨莫儿斯卡娅", "Комсомольская"],
    'Курская': ["Курская", "Kurskaya", "库尔斯卡娅", "Курская"],
    'Таганская': ["Таганская", "Taganskaya", "塔甘斯卡娅", "Таганская"],
    'Павелецкая': ["Павелецкая", "Paveletskaya", "珀维列茨卡娅", "Павелецкая"],
    'Добрынинская': ["Добрынинская", "Dobryninskaya", "多布雷宁斯卡娅", "Добрынинская"],
    'Октябрьская': ["Октябрьская", "Oktyabrskaya", "奥克佳勃斯卡娅", "Октябрьская"],
    'Парк культуры': ["Парк культуры", "Park of Culture", "帕克 库儿图尔", "Парк культуры"],
    'Киевская': ["Киевская", "Kievskaya", "基辅斯卡娅", "Киевская"],
    'Краснопресненская': ["Краснопресненская", "Krasnopresnenskaya", "克拉斯诺普列斯年斯卡娅", "Краснопресненская"],
    'Белорусская': ["Белорусская", "Belorusskaya", "别拉鲁斯卡娅", "Белорусская"],
    'Новослободская': ["Новослободская", "Novoslobodskaya", "诺沃斯洛波得斯卡娅", "Новослободская"],
    'Проспект Мира': ["Проспект Мира", "Avenue of Peace", "普罗斯别克特 米拉", "Мир даңғылы"],

    'Медведково': ["Медведково", "Medvedkovo", "梅德韦得科沃", "Медведково"],
    'Бабушкинская': ["Бабушкинская", "Babushkinskaya", "巴布什肯斯卡娅", "Бабушкинская"],
    'Свиблово': ["Свиблово", "Sviblovo", "斯维勃洛沃", "Свиблово"],
    'Ботанический сад': ["Ботанический сад", "Botanical Garden", "波塔尼切斯基萨德", "Ботаника бағы"],
    'ВДНХ': ["ВДНХ", "VDNKh", "威登汉", "ВДНХ"],
    'Алексеевская': ["Алексеевская", "Alekseevskaya", "阿列克谢耶夫斯ка娅", "Алексеевская"],
    'Рижская': ["Рижская", "Rizhskaya", "里加斯卡娅", "Рижская"],
    'Проспект Мира': ["Проспект Мира", "Avenue of Peace", "普罗斯别克特 米拉", "Мир даңғылы"],
    'Сухаревская': ["Сухаревская", "Sukharevskaya", "苏哈列夫斯卡娅", "Сухаревская"],
    'Тургеневская': ["Тургеневская", "Turgenevskaya", "屠格涅夫斯ка娅", "Тургеневская"],
    'Китай-город': ["Китай-город", "China Town", "基泰格罗德", "Китай-город"],
    'Третьяковская': ["Третьяковская", "Tretyakovskaya", "特列季亞科夫斯卡婭", "Третьяковская"],
    'Октябрьская': ["Октябрьская", "Oktyabrskaya", "奥克佳勃斯卡娅", "Октябрьская"],
    'Шаболовская': ["Шаболовская", "Shabolovskaya", "沙波洛夫斯ка娅", "Шаболовская"],
    'Ленинский проспект': ["Ленинский проспект", "Leninskiy avenue", "列宁斯基 普罗斯别克特", "Ленин даңғылы"],
    'Академическая': ["Академическая", "Akademicheskaya", "阿卡杰米切斯ка娅", "Академическая"],
    'Профсоюзная': ["Профсоюзная", "Trade union", "普罗夫萨由兹纳亚", "Профсоюзная"],
    'Новые Черёмушки': ["Новые Черёмушки", "New Cheryomushki", "诺维耶 切廖木什金", "Новые Черёмушки"],
    'Калужская': ["Калужская", "Kaluzhskaya", "卡卢什斯卡娅", "Калужская"],
    'Беляево': ["Беляево", "Belyaevo", "别利亚耶沃", "Беляево"],
    'Коньково': ["Коньково", "Konkovo", "坎扩沃", "Коньково"],
    'Тёплый Стан': ["Тёплый стан", "Tyopliy Stan", "焦普雷斯坦", "Тёплый Стан"],
    'Ясенево': ["Ясенево", "Yasenevo", "亚谢涅沃", "Ясенево"],
    'Новоясеневская': ["Новоясеневская", "Novoyasenevskaya", "诺沃亚谢聂夫斯卡娅", "Новоясеневская"],

    'Планерная': ["Планерная", "Planernaya", "普兰涅耳纳亚", "Планерная"],
    'Сходненская': ["Сходненская", "Skhodnenskaya", "斯霍德宁斯卡娅", "Сходненская"],
    'Тушинская': ["Тушинская", "Tushinskaya", "图申斯卡娅", "Тушинская"],
    'Спартак': ["Спартак", "Spartak", "斯巴达克", "Спартак"],
    'Щукинская': ["Щукинская", "Schukinskaya", "休金斯卡娅", "Щукинская"],
    'Октябрьское Поле': ["Октябрьское Поле", "October Field", "奥克佳勃斯科耶 珀列", "Октябрьское Поле"],
    'Полежаевская': ["Полежаевская", "Polezhaevskaya", "珀列让耶夫斯卡娅", "Полежаевская"],
    'Беговая': ["Беговая", "Begovaya", "别郭娃娅", "Беговая"],
    'Улица 1905 года': ["Улица 1905 года", "Street of 1905", "乌利擦 1905 国达", "1905 год көшесі"],
    'Баррикадная': ["Баррикадная", "Barrikadnaya", "巴里卡德纳亚", "Баррикадная"],
    'Пушкинская': ["Пушкинская", "Pushkinskaya", "普希金斯卡娅", "Пушкинская"],
    'Кузнецкий Мост': ["Кузнецкий Мост", "Kuznetskiy Most", "库慈涅茨基 莫斯特", "Кузнецкий Мост"],
    'Китай-город': ["Китай-город", "China Town", "基泰格罗德", "Китай-город"],
    'Таганская': ["Таганская", "Taganskaya", "塔甘斯卡娅", "Таганская"],
    'Пролетарская': ["Пролетарская", "Proletarskaya", "普罗列塔尔斯卡普希金斯卡娅", "Пролетарская"],
    'Волгоградский проспект': ["Волгоградский проспект", "Volgogradskiy avenue", "伏尔加格勒斯基 普罗斯别克特", "Волгоградский даңғылы"],
    'Текстильщики': ["Текстильщики", "Tekstilschiki", "杰克斯吉利西基", "Текстильщики"],
    'Кузьминки': ["Кузьминки", "Kuzminki", "库慈明基", "Кузьминки"],
    'Рязанский проспект': ["Рязанский проспект", "Ryazanskiy avenue", "梁赞斯基普罗斯别克特", "Рязанский даңғылы"],
    'Выхино': ["Выхино", "Vykhino", "维黑诺", "Выхино"],
    'Лермонтовский проспект': ["Лермонтовский проспект", "Lermontovskiy avenue", "莱蒙托夫斯基普罗斯别克特", "Лермонтов даңғылы"],
    'Жулебино': ["Жулебино", "Zhulebino", "茹列宾诺", "Жулебино"],
    'Котельники': ["Котельники", "Kotelniki", "科捷尔尼基", "Котельники"],

    'Новокосино': ["Новокосино", "Novokosino", "诺沃科西诺", "Новокосино"],
    'Новогиреево': ["Новогиреево", "Novogireevo", "诺沃基列沃", "Новогиреево"],
    'Перово': ["Перово", "Perovo", "别罗沃", "Перово"],
    'Шоссе Энтузиастов': ["Шоссе Энтузиастов", "Shosse Entuziastov", "绍赛 因图慈阿斯特夫", "Энтузиасты тас жолы"],
    'Авиамоторная': ["Авиамоторная", "Aviamotornaya", "阿维啊莫托尔纳亚", "Авиамоторная"],
    'Площадь Ильича': ["Площадь Ильича", "Ilyich Square", "伊里奇廣場", "Ильич алаңы"],
    'Марксистская': ["Марксистская", "Marksistskaya", "马尔克西斯卡娅", "Марксистская"],
    'Третьяковская': ["Третьяковская", "Tretyakovskaya", "特列季亞科夫斯卡婭", "Третьяковская"],

    'Деловой Центр': ["Деловой Центр", "Business Center", "杰罗沃Й Центр", "Деловой центр"],
    'Парк Победы': ["Парк Победы", "Victory Park", "怕克珀别得", "Победа саябағы"],
    'Минская': ["Минская", "Minskaya", "明斯克亚", "Минская"],
    'Ломоносовский проспект': ["Ломоносовский проспект", "Lomonosovskiy avenue", "罗蒙诺索夫斯киープロスポケ", "Ломоносов даңғылы"],
    'Раменки': ["Раменки", "Ramenki", "拉缅基", "Раменки"],
    'Мичуринский проспект': ["Мичуринский проспект", "Michurinskiy avenue", "米出林斯基普罗斯别克特", "Мичурин даңғылы"],
    'Озёрная': ["Озёрная", "Ozyornaya", "奥焦尔纳亚", "Озёрная"],
    'Говорово': ["Говорово", "Govorovo", "格沃罗沃", "Говорово"],
    'Солнцево': ["Солнцево", "Solntsevo", "索勒恩采沃", "Солнцево"],
    'Боровское шоссе': ["Боровское шоссе", "Borovskoe highway", "勃罗夫斯卡耶 绍赛", "Боровское тас жолы"],
    'Новопеределкино': ["Новопеределкино", "Novoperedelkino", "诺沃别列杰利基诺", "Новопеределкино"],
    'Рассказовка': ["Рассказовка", "Rasskazovka", "拉斯卡佐夫卡", "Рассказовка"],
    'Пыхтино': ["Пыхтино", "Pykhtino", "佩赫季诺站", "Пыхтино"],
    'Аэропорт Внуково': ["Аэропорт Внуково", "Airport Vnukovo", "伏努科沃机场站", "Внуково әуежайы"],

    'Алтуфьево': ["Алтуфьево", "Altufyevo", "奥图夫耶沃", "Алтуфьево"],
    'Бибирево': ["Бибирево", "Bibirevo", "毕比列沃", "Бибирево"],
    'Отрадное': ["Отрадное", "Otradnoe", "奥特拉得诺耶", "Отрадное"],
    'Владыкино': ["Владыкино", "Vladykino", "弗拉德金诺", "Владыкино"],
    'Петровско-Разумовская': ["Петровско-Разумовская", "Petrovsko-Razumovskaya", "彼特洛夫斯科-拉祖莫夫斯卡娅", "Петровско-Разумовская"],
    'Тимирязевская': ["Тимирязевская", "Timiryazevskaya", "季米梁捷夫斯卡娅", "Тимирязевская"],
    'Дмитровская': ["Дмитровская", "Dmitrovskaya", "德米特罗夫斯卡娅", "Дмитровская"],
    'Савёловская': ["Савёловская", "Savyolovskaya", "萨维洛夫斯卡娅", "Савёловская"],
    'Менделеевская': ["Менделеевская", "Mendeleevskaya", "门捷列夫斯卡亚娅", "Менделеевская"],
    'Цветной бульвар': ["Цветной бульвар", "Tsvetnoy Boulevard", "茨维特诺Й 布儿瓦尔", "Цветной бульвар"],
    'Чеховская': ["Чеховская", "Chekhovskaya", "契科夫斯卡娅", "Чеховская"],
    'Боровицкая': ["Боровицкая", "Borovitskaya", "波罗维茨卡娅", "Боровицкая"],
    'Полянка': ["Полянка", "Polyanka", "珀梁卡", "Полянка"],
    'Серпуховская': ["Серпуховская", "Serpukhovskaya", "谢尔普霍夫斯卡娅", "Серпуховская"],
    'Тульская': ["Тульская", "Tulskaya", "图尔斯卡娅", "Тульская"],
    'Нагатинская': ["Нагатинская", "Nagatinskaya", "纳噶金斯卡娅", "Нагатинская"],
    'Нагорная': ["Нагорная", "Nagornaya", "纳郭尔纳亚", "Нагорная"],
    'Нахимовский проспект': ["Нахимовский проспект", "Nakhimovskiy avenue", "纳黑莫夫斯基别克特", "Нахимовский проспект"],
    'Севастопольская': ["Севастопольская", "Sevastopolskaya", "谢瓦斯托贝利斯卡娅", "Севастопольская"],
    'Чертановская': ["Чертановская", "Chertanovskaya", "切尔塔诺夫斯卡娅", "Чертановская"],
    'Южная': ["Южная", "South", "由日纳亚", "Оңтүстік"],
    'Пражская': ["Пражская", "Prazhskaya", "普拉什斯卡娅", "Прага"],
    'Улица Академика Янгеля': ["Улица Академика Янгеля", "Academician Yangel Street", "乌利察 阿卡杰米卡杨格利亚", "Академик Янгель көшесі"],
    'Аннино': ["Аннино", "Annino", "安尼诺", "Аннино"],
    'Бульвар Дмитрия Донского': ["Бульвар Дмитрия Донского", "Dmitry Donskoy Boulevard", "布儿瓦尔 德米特利 顿斯科沃", "Дмитрий Донской бульвары"],

    'Физтех': ["Физтех", "Fiztekh", "莫斯科物理技术学院站", "Физтех"],
    'Лианозово': ["Лианозово", "Lianozovo", "利亚诺佐沃站", "Лианозово"],
    'Яхромская': ["Яхромская", "Yakhromskaya", "亚赫罗马站", "Яхромская"],
    'Селигерская': ["Селигерская", "Seligerskaya", "谢利捷尔斯卡娅", "Селигерская"],
    'Верхние Лихоборы': ["Верхние Лихоборы", "Upper Likhobory", "韦尔哈尼伊 利霍勃雷", "Верхние Лихоборы"],
    'Окружная': ["Окружная", "Okruzhnaya", "奥科茹日纳亚", "Окружная"],
    'Петровско-Разумовская': ["Петровско-Разумовская", "Petrovsko-Razumovskaya", "彼特洛夫斯科-拉祖莫夫斯卡娅", "Петровско-Разумовская"],
    'Фонвизинская': ["Фонвизинская", "Fonvizinskaya", "冯维辛斯卡娅", "Фонвизинская"],
    'Бутырская': ["Бутырская", "Butyrskaya", "布特尔斯卡娅", "Бутырская"],
    'Марьина роща': ["Марьина роща", "Maryina grove", "玛莉娜因诺 罗夏", "Марьина Роща"],
    'Достоевская': ["Достоевская", "Dostoevskaya", "陀思妥耶夫斯卡娅", "Достоевская"],
    'Трубная': ["Трубная", "Trubnaya", "特鲁勃纳亚", "Трубная"],
    'Сретенский бульвар': ["Сретенский бульвар", "Sretensky Boulevard", "斯列金斯基 布儿瓦尔", "Сретенский бульвар"],
    'Чкаловская': ["Чкаловская", "Chkalovskaya", "契卡洛夫斯卡娅", "Чкаловская"],
    'Римская': ["Римская", "Rimskaya", "里姆斯卡娅", "Рим"],
    'Крестьянская Застава': ["Крестьянская застава", "Peasant outpost", "克列斯吉杨斯卡娅扎斯塔瓦站", "Крестьянская Застава"],
    'Дубровка': ["Дубровка", "Dubrovka", "杜布罗夫卡", "Дубровка"],
    'Кожуховская': ["Кожуховская", "Kozhukhovskaya", "卡茹霍夫斯卡娅", "Кожуховская"],
    'Печатники': ["Печатники", "Pechatniki", "别恰特尼基", "Печатники"],
    'Волжская': ["Волжская", "Volzhskaya", "沃儿什斯卡娅", "Волжская"],
    'Люблино': ["Люблино", "Lyublino", "留布林诺", "Люблино"],
    'Братиславская': ["Братиславская", "Bratislavskaya", "勃拉吉斯辣夫斯卡娅", "Братиславская"],
    'Марьино': ["Марьино", "Maryino", "玛里因诺", "Марьино"],
    'Борисово': ["Борисово", "Borisovo", "波里索沃", "Борисово"],
    'Шипиловская': ["Шипиловская", "Shipilovskaya", "什皮洛夫斯卡娅", "Шипиловская"],
    'Зябликово': ["Зябликово", "Zyablikovo", "扎布利科沃", "Зябликово"],

    'Савёловская': ["Савёловская", "Savyolovskaya", "萨维洛夫斯卡娅", "Савёловская"],
    'Петровский парк': ["Петровский парк", "Petrovskiy Park", "彼得尔夫斯基 帕克", "Петровский парк"],
    'ЦСКА': ["ЦСКА", "CSKA", "慈额斯卡", "ЦСКА"],
    'Хорошёвская': ["Хорошёвская", "Khoroshyovskaya", "哈拉休夫斯卡亚", "Хорошёвская"],

    'Народное Ополчение': ["Народное Ополчение", "People's Militia", "纳罗德诺叶 奥波尔切尼叶", "Народное Ополчение"],
    'Мнёвники': ["Мнёвники", "Mnyovniki", "密涅夫尼基", "Мнёвники"],
    'Терехово': ["Терехово", "Terekhovo", "捷列霍во", "Терехово"],
    'Кунцевская': ["Кунцевская", "Kuntsevskaya", "昆采沃斯卡亚", "Кунцевская"],
    'Давыдково': ["Давыдково", "Davydkovo", "达维得科沃", "Давыдково"],
    'Аминьевская': ["Аминьевская", "Aminyevskaya", "阿米尼弗斯卡亚", "Аминьевская"],
    'Мичуринский проспект': ["Мичуринский проспект", "Michurinskiy avenue", "米丘林斯基 普罗斯别克特", "Мичуринский проспект"],
    'Проспект Вернадского': ["Проспект Вернадского", "Avenue Vernadskogo", "普罗斯别克特 维尔纳茨克郭", "Проспект Вернадского"],
    'Новаторская': ["Новаторская", "Novatorskaya", "诺娃特罗夫斯卡娅", "Новаторская"],
    'Воронцовская': ["Воронцовская", "Vorontsovskaya", "沃龙措夫斯卡亚", "Воронцовская"],
    'Зюзино': ["Зюзино", "Zyuzino", "久基诺", "Зюзино"],
    'Каховская': ["Каховская", "Kakhovskaya", "卡霍夫斯卡亚", "Каховская"],
    'Варшавская': ["Варшавская", "Varshavskaya", "瓦儿沙夫斯卡亚", "Варшавская"],
    'Каширская': ["Каширская", "Kashirskaya", "卡希尔斯卡亚", "Каширская"],
    'Кленовый бульвар': ["Кленовый бульвар", "Maple Boulevard", "颗粒诺维 布儿瓦尔", "Кленовый бульвар"],
    'Нагатинский Затон': ["Нагатинский Затон", "Nagatinskiy Zaton", "纳噶金斯克伊 扎通", "Нагатинский затон"],
    'Печатники': ["Печатники", "Pechatniki", "别恰特尼基", "Печатники"],
    'Текстильщики': ["Текстильщики", "Tekstilschiki", "杰克斯吉利西基", "Текстильщики"],
    'Нижегородская': ["Нижегородская", "Nizhegorodskaya", "尼若郭若德斯卡亚", "Нижегородская"],
    'Авиамоторная': ["Авиамоторная", "Aviamotornaya", "航空发动机站", "Авиамоторная"],
    'Лефортово': ["Лефортово", "Lefortovo", "列福尔托沃", "Лефортово"],
    'Электрозаводская': ["Электрозаводская", "Elektrozavodskaya", "哎列克特拉扎沃得斯卡亚", "Электрозаводская"],
    'Сокольники': ["Сокольники", "Sokolniki", "索科利尼吉", "Сокольники"],
    'Рижская': ["Рижская", "Rizhskaya", "里加斯卡娅", "Рижская"],
    'Марьина Роща': ["Марьина Роща", "Maryina Grove", "玛莉娜因诺 罗夏", "Марьина Роща"],

    'Битцевский парк': ["Битцевский парк", "Bitsevskiy Park", "毕茨夫斯克帕克", "Битце саябағы"],
    'Лесопарковая': ["Лесопарковая", "Lesoparkovaya", "列所帕克瓦亚", "Лесопарковая"],
    'Улица Старокачаловская': ["Улица Старокачаловская", "Starokachalovskaya street", "乌利察 斯塔罗卡恰洛夫斯卡娅", "Старокачаловская көшесі"],
    'Улица Скобелевская': ["Улица Скобелевская", "Skobelevskaya street", "乌利察 斯科别列夫斯卡娅", "Скобелевская көшесі"],
    'Бульвар Адмирала Ушакова': ["Бульвар Адмирала Ушакова", "Admiral Ushakov Boulevard", "布儿瓦尔 阿得米拉儿乌沙科瓦", "Адмирал Ушаков бульвары"],
    'Улица Горчакова': ["Улица Горчакова", "Gorchakov Street", "乌利察 郭尔恰科瓦", "Горчаков көшесі"],
    'Бунинская аллея': ["Бунинская аллея", "Buninskaya Alley", "蒲宁斯卡娅阿列亚", "Бунинская аллеясы"],
    'Измайловская': ["Измайловская", "Izmailovskaya", "伊茲邁洛夫斯卡婭", "Измайловская"],

    'Бульвар Рокоссовского': ["Бульвар Рокоссовского", "Rokossovsky Boulevard", "布儿娃尔罗科索夫斯科郭", "Рокоссовский бульвары"],
    'Локомотив': ["Локомотив", "Lokomotiv", "拉科马基夫", "Локомотив"],
    'Измайлово': ["Измайлово", "Izmaylovo", "伊慈迈诺沃", "Измайлово"],
    'Соколиная Гора': ["Соколиная Гора", "Falcons Mountain", "索科利纳亚 郭拉", "Соколиная тауы"],
    'Шоссе Энтузиастов': ["Шоссе Энтузиастов", "Enthusiasts Highway", "绍赛 因图季阿斯特夫", "Энтузиасты тас жолы"],
    'Андроновка': ["Андроновка", "Andronovka", "按德罗诺夫卡", "Андроновка"],
    'Нижегородская': ["Нижегородская", "Nizhegorodskaya", "尼热郭罗德斯卡娅", "Нижегородская"],
    'Новохохловская': ["Новохохловская", "Novokhokhlovskaya", "诺沃霍哈罗夫斯卡娅", "Новохохловская"],
    'Угрешская': ["Угрешская", "Ugreshskaya", "乌格雷斯卡娅", "Ýgreshskaıa"],
    'Дубровка': ["Дубровка", "Dubrovka", "杜布罗夫卡", "Дубровка"],
    'Автозаводская': ["Автозаводская", "Avtozavodskaya", "阿夫托扎沃德斯卡娅", "Автозаводская"],
    'ЗИЛ': ["ЗИЛ", "ZIL", "济勒", "ЗИЛ"],
    'Верхние Котлы': ["Верхние Котлы", "Upper Boilers", "维尔哈尼耶ка特乐", "Верхние Котлы"],
    'Крымская': ["Крымская", "Krymskaya", "克里木斯卡娅", "Крымская"],
    'Площадь Гагарина': ["Площадь Гагарина", "Gagarin Square", "普洛夏基 加加林纳", "Гагарин алаңы"],
    'Лужники': ["Лужники", "Luzhniki", "卢日尼基", "Лужники"],
    'Кутузовская': ["Кутузовская", "Kutuzovskaya", "库图佐夫斯卡娅", "Кутузовская"],
    'Москва-Сити': ["Москва-Сити", "Moscow-City", "莫斯科城", "Москва-Сити"],
    'Шелепиха': ["Шелепиха", "Shelepikha", "谢列彼哈", "Шелепиха"],
    'Хорошёво': ["Хорошёво", "Khoroshyovo", "霍罗绍夫区", "Хорошёво"],
    'Зорге': ["Зорге", "Zorge", "佐耳格", "Зорге"],
    'Панфиловская': ["Панфиловская", "Panfilovskaya", "潘菲洛夫斯卡亚", "Панфиловская"],
    'Стрешнево': ["Стрешнево", "Streshnevo", "斯特列什涅沃", "Стрешнево"],
    'Балтийская': ["Балтийская", "Baltiyskaya", "巴罗季伊斯卡娅", "Балтийская"],
    'Коптево': ["Коптево", "Koptevo", "科普切沃", "Коптево"],
    'Лихоборы': ["Лихоборы", "Likhobory", "利霍波尔", "Лихоборы"],
    'Окружная': ["Окружная", "Okruzhnaya", "奥科茹日纳亚", "Окружная"],
    'Владыкино': ["Владыкино", "Vladykino", "弗拉德金诺", "Владыкино"],
    'Ботанический сад': ["Ботанический сад", "Botanical Garden", "波塔尼切斯基萨德", "Ботаника бағы"],
    'Ростокино': ["Ростокино", "Rostokino", "罗斯托基诺", "Ростокино"],
    'Белокаменная': ["Белокаменная", "Belokamennaya", "别罗卡门斯ка娅", "Белокаменная"],

    'Нижегородская': ["Нижегородская", "Nizhegorodskaya", "尼热郭罗德斯卡娅", "Нижегородская"],
    'Стахановская': ["Стахановская", "Stakhanovskaya", "斯达汉诺夫斯卡娅", "Стахановская"],
    'Окская': ["Окская", "Okskaya", "奥科斯卡娅", "Окская"],
    'Юго-Восточная': ["Юго-Восточная", "South-Eastern", "由噶沃斯托期纳亚", "Оңтүстік-Шығыс"],
    'Косино': ["Косино", "Kosino", "科西诺", "Косино"],
    'Улица Дмитриевского': ["Улица Дмитриевского", "Dmitrievsky Street", "乌利察 德米特利耶夫斯ко沃", "Дмитриевский көшесі"],
    'Лухмановская': ["Лухмановская", "Lukhmanovskaya", "卢赫玛诺夫斯卡娅", "Лухмановская"],
    'Некрасовка': ["Некрасовка", "Nekrasovka", "涅克拉索夫卡", "Некрасовка"],

    'Новаторская': ["Новаторская", "Novatorskaya", "诺娃托尔斯卡娅", "Жаңашыл"],
    'Университет дружбы народов': ["Университет дружбы народов", "Peoples' Friendship University", "俄罗斯人民友谊大学", "Халықтар достығы университеті"],
    'Генерала Тюленева': ["Генерала Тюленева", "General Tyulenev", "秋列涅夫将军", "Генерал Тюленев"],
    'Тютчевская': ["Тютчевская", "Tyutchevskaya", "秋切夫斯ка娅", "Тютчевская"],

    'Лобня': ["Лобня", "Lobnya", "洛布尼亚", "Лобня"],
    'Шереметьевская': ["Шереметьевская", "Sheremetyevskaya", "谢列梅捷沃斯卡亚", "Шереметьев"],
    'Хлебниково': ["Хлебниково", "Khlebinikovo", "哈列巴尼科沃", "Хлебниково"],
    'Водники': ["Водники", "Vodniki", "沃德尼克", "Водники"],
    'Долгопрудная': ["Долгопрудная", "Dolgoprudnaya", "多尔戈普鲁德纳亚", "Долгопрудный"],
    'Новодачная': ["Новодачная", "Novodachnaya", "诺沃达恰纳亚", "Новодачная"],
    'Марк': ["Марк", "Mark", "马克", "Марк"],
    'Лианозово': ["Лианозово", "Lianozovo", "利阿诺佐沃", "Лианозово"],
    'Илимская': ["Илимская", "Ilimskaya", "伊莉姆斯卡娅", "Ілім"],
    'Бескудниково': ["Бескудниково", "Beskudnikovo", "别斯库德尼阔沃", "Бескудниково"],
    'Дегунино': ["Дегунино", "Degunino", "杰尔故尼诺", "Дегунино"],
    'Окружная': ["Окружная", "Okruzhnaya", "奥科茹日纳亚", "Окружная"],
    'Петровско-Разумовская': ["Петровско-Разумовская", "Petrovsko-Razumovskaya", "彼得罗夫-拉祖莫夫站", "Петровско-Разумовская"],
    'Тимирязевская': ["Тимирязевская", "Timiryazevskaya", "季米梁捷夫斯каЯ", "Тимирязевская"],
    'Дмитровская': ["Дмитровская", "Dmitrovskaya", "德米特罗夫斯ка娅", "Дмитровская"],
    'Савёловская': ["Савёловская", "Savyolovskaya", "萨维奥洛沃斯卡亚", "Савёловская"],
    'Белорусская': ["Белорусская", "Belorusskaya", "别拉鲁斯卡亚", "Белорусская"],
    'Беговая': ["Беговая", "Begovaya", "别郭瓦亚", "Беговая"],
    'Тестовская': ["Тестовская", "Testovskaya", "特斯托夫斯卡婭", "Тестовская"],
    'Москва-Сити': ["Москва-Сити", "Moscow-City", "莫斯科城", "Мәскеу Қаласы"],
    'Фили': ["Фили", "Fili", "费利", "Фили"],
    'Славянский бульвар': ["Славянский бульвар", "Slavic Boulevard", "斯拉维扬斯基布儿瓦尔", "Славян бульвары"],
    'Кунцевская': ["Кунцевская", "Kuntsevskaya", "昆采沃斯卡亚", "Кунцевская"],
    'Рабочий Посёлок': ["Рабочий Посёлок", "Workers' Settlement", "拉波奇伊 波休罗к", "Рабочий Посёлок"],
    'Сетунь': ["Сетунь", "Setun", "谢通", "Сетунь"],
    'Немчиновка': ["Немчиновка", "Nemchinovka", "涅木其诺夫卡", "Немчиновка"],
    'Сколково': ["Сколково", "Skolkovo", "斯科尔科沃", "Сколково"],
    'Баковка': ["Баковка", "Bakovka", "巴科夫ка", "Баковка"],
    'Одинцово': ["Одинцово", "Odintsovo", "奥金佐沃", "Одинцово"],

    'Нахабино': ["Нахабино", "Nakhabino", "纳哈宾诺", "Нахабино"],
    'Аникеевка': ["Аникеевка", "Anikeevka", "阿尼科捷耶夫ка", "Аникеевка"],
    'Опалиха': ["Опалиха", "Opalikha", "奥巴利哈", "Опалиха"],
    'Красногорская': ["Красногорская", "Krasnogorskaya", "克拉斯诺戈尔斯卡亚", "Красногорская"],
    'Павшино': ["Павшино", "Pavshino", "巴乌什诺", "Павшино"],
    'Пенягино': ["Пенягино", "Penyagino", "别尼亚基诺", "Пенягино"],
    'Волоколамская': ["Волоколамская", "Volokolamskaya", "沃洛科拉姆斯卡亚", "Волоколамская"],
    'Трикотажная': ["Трикотажная", "Trikotazhnaya", "德利科达日纳亚", "Трикотажная"],
    'Тушинская': ["Тушинская", "Tushinskaya", "图申斯ка亚", "Тушинская"],
    'Щукинская': ["Щукинская", "Shukinskaya", "休金斯卡娅", "Щукинская"],
    'Стрешнево': ["Стрешнево", "Streshnevo", "斯特列什涅沃", "Стрешнево"],
    'Красный Балтиец': ["Красный Балтиец", "Red Baltic", "克拉斯尼伊 巴勒基耶茨", "Красный Балтиец"],
    'Гражданская': ["Гражданская", "Civil", "葛拉日达讷斯卡亚", "Гражданская"],
    'Дмитровская': ["Дмитровская", "Dmitrovskaya", "德米特罗夫斯卡娅", "Дмитровская"],
    'Марьина Роща': ["Марьина Роща", "Maryina Grove", "玛莉娜因诺 罗夏", "Марьина Роща"],
    'Рижская': ["Рижская", "Rizhskaya", "里加斯卡亚", "Рижская"],
    'Площадь трёх вокзалов': ["Площадь трёх вокзалов", "Area of three stations", "卡拉乔夫斯卡娅", "Площадь трёх вокзалов"],
    'Курская': ["Курская", "Kurskaya", "库尔斯卡娅", "Курская"],
    'Москва-Товарная': ["Москва-Товарная", "Moscow-Tovarnaya", "莫斯科- 托瓦尔纳亚", "Москва-Товарная"],
    'Калитники': ["Калитники", "Kalitniki", "卡利特尼科", "Калитники"],
    'Новохохловская': ["Новохохловская", "Novokhokhlovskaya", "诺沃霍哈罗夫斯卡娅", "Новохохловская"],
    'Текстильщики': ["Текстильщики", "Tekstilschiki", "杰克斯吉利西基", "Текстильщики"],
    'Печатники': ["Печатники", "Pechatniki", "别恰特尼基", "Печатники"],
    'Люблино': ["Люблино", "Kubanskaya", "库邦斯卡娅", "Люблино"],
    'Депо': ["Депо", "Depo", "杰波", "Депо"],
    'Перерва': ["Перерва", "Pererva", "别列勒娃", "Перерва"],
    'Курьяново': ["Курьяново", "Kuryanovo", "库利杨诺沃", "Курьяново"],
    'Москворечье': ["Москворечье", "Moskvorechye", "莫斯科沃列奇耶", "Москворечье"],
    'Царицыно': ["Царицыно", "Tsaritsyno", "察里津诺", "Царицыно"],
    'Котляково': ["Котляково", "Kotlyakovo", "科特里亚克沃", "Котляково"],
    'Покровское': ["Покровское", "Pokrovskoe", "波克罗夫斯科耶", "Покровское"],
    'Красный Строитель': ["Красный Строитель", "Red Builder", "克拉斯尼伊-斯特罗й捷利", "Красный Строитель"],
    'Битца': ["Битца", "Bitsa", "毕察", "Битца"],
    'Бутово': ["Бутово", "Butovo", "布托沃", "Бутово"],
    'Щербинка': ["Щербинка", "Scherbinka", "谢宾卡", "Щербинка"],
    'Остафьево': ["Остафьево", "Ostafyevo", "奥斯达菲沃", "Остафьево"],
    'Силикатная': ["Силикатная", "Silikatnaya", "谢利卡特纳亚", "Силикатная"],
    'Подольск': ["Подольск", "Podolsk", "波多利斯克", "Подольск"],

    'Зеленоград-Крюково': ["Зеленоград-Крюково", "Zelenograd-Kryukovo", "泽列诺格勒站 (克留科沃站)", "Зеленоград-Крюково"],
    'Фирсановская': ["Фирсановская", "Firsanovskaya", "菲尔萨诺夫斯卡亚站", "Фирсановская"],
    'Сходня': ["Сходня", "Skhodnya", "斯霍德尼站", "Сходня"],
    'Подрезково': ["Подрезково", "Podrezkovo", "波德列兹科沃站", "Подрезково"],
    'Новоподрезково': ["Новоподрезково", "Novopodrezkovo", "新波德列兹科沃站", "Новоподрезково"],
    'Молжаниново': ["Молжаниново", "Molzhaninovo", "莫尔扎尼诺沃站", "Молжаниново"],
    'Химки': ["Химки", "Khimki", "希姆基站", "Химки"],
    'Левобережная': ["Левобережная", "Levoberezhnaya", "左岸站", "Левобережная"],
    'Ховрино': ["Ховрино", "Khovrino", "霍夫林诺站", "Ховрино"],
    'Грачёвская': ["Грачёвская", "Grachyovskaya", "格拉乔夫卡斯卡亚站", "Грачёвская"],
    'Моссельмаш': ["Моссельмаш", "Mosselmash", "莫斯科农业机器制造厂站", "Моссельмаш"],
    'Лихоборы': ["Лихоборы", "Likhobory", "利霍波瑞站", "Лихоборы"],
    'Петровско-Разумовская': ["Петровско-Разумовская", "Petrovsko-Razumovskaya", "彼得罗夫-拉祖莫夫站", "Петровско-Разумовская"],
    'Останкино': ["Останкино", "Ostankino", "奥斯坦金诺站", "Останкино"],
    'Рижская': ["Рижская", "Rizhskaya", "里加站", "Рижская"],
    'Митьково': ["Митьково", "Mitkovo", "米特科沃站", "Митьково"],
    'Электрозаводская': ["Электрозаводская", "Elektrozavodskaya", "发电厂站", "Электрозаводская"],
    'Сортировочная': ["Сортировочная", "Sortirovochnaya", "卸货场站", "Сортировочная"],
    'Авиамоторная': ["Авиамоторная", "Aviamotornaya", "航空发动机站", "Авиамоторная"],
    'Андроновка': ["Андроновка", "Andronovka", "安德罗诺夫卡站", "Андроновка"],
    'Перовo': ["Перовo", "Perovo", "佩罗沃站", "Перово"],
    'Плющево': ["Плющево", "Plyuschevo", "普柳谢沃站", "Плющево"],
    'Вешняки': ["Вешняки", "Veshnyaki", "韦什尼亚基站", "Вешняки"],
    'Выхино': ["Выхино", "Vykhino", "维希诺站", "Выхино"],
    'Косино': ["Косино", "Kosino", "科西诺站", "Косино"],
    'Ухтомская': ["Ухтомская", "Ukhtomskaya", "乌赫托姆斯卡亚站", "Ухтомская"],
    'Люберцы': ["Люберцы", "Lyubertsy", "柳别尔齐站", "Люберцы"],
    'Панки': ["Панки", "Panki", "朋克站", "Панки"],
    'Томилино': ["Томилино", "Tomilino", "多米里诺站", "Томилино"],
    'Красково': ["Красково", "Kraskovo", "克拉斯科沃站", "Красково"],
    'Малаховка': ["Малаховка", "Malakhovka", "马拉霍夫卡站", "Малаховка"],
    'Удельная': ["Удельная", "Udelnaya", "乌杰利纳亚站", "Удельная"],
    'Быково': ["Быково", "Bykovo", "彼科沃站", "Быково"],
    'Ильинская': ["Ильинская", "Ilyinskaya", "伊林斯卡亚站", "Ильинская"],
    'Отдых': ["Отдых", "Rest", "休息站", "Отдых"],
    'Кратово': ["Кратово", "Kratovo", "克拉托沃站", "Кратово"],
    'Есенинская': ["Есенинская", "Eseninskaya", "叶赛宁站", "Есенинская"],
    'Фабричная': ["Фабричная", "Fabrichnaya", "工厂站", "Фабричная"],
    'Раменское': ["Раменское", "Ramenskoe", "拉缅斯科耶站", "Раменское"],
    'Ипподром': ["Ипподром", "Hippodrome", "马场站", "Ипподром"],

    'Железнодорожная': ["Железнодорожная", "Railway", "铁路站", "Железнодорожная"],
    'Ольгино': ["Ольгино", "Olgino", "奥尔吉诺站", "Ольгино"],
    'Кучино': ["Кучино", "Kuchino", "库奇诺站", "Кучино"],
    'Салтыковская': ["Салтыковская", "Saltykovskaya", "萨尔特科夫斯卡亚站", "Салтыковская"],
    'Никольское': ["Никольское", "Nikolskoe", "尼科尔斯科耶站", "Никольское"],
    'Реутов': ["Реутов", "Reutov", "列乌托夫站", "Реутов"],
    'Новогиреево': ["Новогиреево", "Novogireevo", "新吉列耶沃站", "Новогиреево"],
    'Кусково': ["Кусково", "Kuskovo", "库斯科沃站", "Кусково"],
    'Чухлинка': ["Чухлинка", "Chukhlinka", "丘赫林卡站", "Чухлинка"],
    'Нижегородская': ["Нижегородская", "Nizhegorodskaya", "下诺夫哥罗德站", "Нижегородская"],
    'Серп и Молот': ["Серп и Молот", "Hammer and Sickle", "镰刀与锤子站", "Серп и Молот"],
    'Курская': ["Курская", "Kurskaya", "库尔斯克站", "Курская"],
    'Площадь трёх вокзалов': ["Площадь трёх вокзалов", "Area of three stations", "三线交汇广场站", "Площадь трёх вокзалов"],
    'Марьина Роща': ["Марьина Роща", "Maryina Grove", "玛莉娜林站", "Марьина Роща"],
    'Савёловская': ["Савёловская", "Savyolovskaya", "萨维奥洛沃站", "Савёловская"],
    'Белорусская': ["Белорусская", "Belorusskaya", "白俄罗斯站", "Белорусская"],
    'Москва-Сити': ["Москва-Сити", "Moscow-City", "莫斯科城", "Москва-Сити"],
    'Кутузовская': ["Кутузовская", "Kutuzovskaya", "库图佐夫站", "Кутузовская"],
    'Поклонная': ["Поклонная", "Poklonnaya", "伏首山站", "Поклонная"],
    'Минская': ["Минская", "Minskaya", "明斯克站", "Минская"],
    'Матвеевская': ["Матвеевская", "Matveevskaya", "马特维耶夫站", "Матвеевская"],
    'Аминьевская': ["Аминьевская", "Aminyevskaya", "阿米涅夫斯卡娅站", "Аминьевская"],
    'Очаково': ["Очаково", "Ochakovo", "奥恰科夫站", "Очаково"],
    'Мещерская': ["Мещерская", "Mescherskaya", "梅谢尔斯卡娅站", "Мещерская"],
    'Солнечная': ["Солнечная", "Solar", "太阳站", "Солнечная"],
    'Переделкино': ["Переделкино", "Peredelkino", "佩列杰尔基诺站", "Переделкино"],
    'Мичуринец': ["Мичуринец", "Michurinets", "米丘林人站", "Мичуринец"],
    'Внуково': ["Внуково", "Vnukovo", "伏努科沃站", "Внуково"],
    'Лесной Городок': ["Лесной Городок", "Forest Town", "列斯诺伊城站", "Лесной Городок"],
    'Толстопальцево': ["Толстопальцево", "Tolstopaltsevo", "托尔斯托帕尔采沃站", "Толстопальцево"],
    'Кокошкино': ["Кокошкино", "Kokoshkino", "科科什基诺站", "Кокошкино"],
    'Санино': ["Санино", "Sanino", "萨尼诺站", "Санино"],
    'Крёкшино': ["Крёкшино", "Kryokshino", "克雷克希诺站", "Крёкшино"],
    'Победа': ["Победа", "Victory", "胜利站", "Победа"],
    'Апрелевка': ["Апрелевка", "Aprelevka", "阿普雷列夫卡站", "Апрелевка"],

    'Солнечная': ["Солнечная", "Solar", "太阳能", "Kún shýaqty"],
    'Крёкшино': ["Крёкшино", "Kryokshino", "克雷克希诺站", "Крёкшино"],

    'Отправление': ["Отправление", "Departure", "離開", "Kету"],
    'Прибытие на станцию': ["Прибытие на станцию", "Arriving at the station","到達車站", "Вокзалға келу"],
    'Очистить': ["Очистить", "Clear", "清除", "Таза"],
    'Отсюда': ["Отсюда", "From here", "從這裡", "Осы жерден"],
    'Сюда': ["Сюда", "Here", "這裡", "Мұнда"],

    'Скрыта {n} станция. Нажмите, чтобы посмотреть.': [
        'Скрыта {n} станция. Нажмите, чтобы посмотреть.',
        'Hidden {n} station. Click to view.',
        '隱藏 {n} 車站。點擊查看',
        '{n} станция жасырылған. Қарау үшін басыңыз.'
    ],
    'Скрыты {n} станции. Нажмите, чтобы посмотреть.': [
        'Скрыты {n} станции. Нажмите, чтобы посмотреть.',
        'Hidden {n} stations. Click to view.',
        '隱藏 {n} 車站。點擊查看',
        '{n} станция жасырылған. Қарау үшін басыңыз.'
    ],
    'Скрыты {n} станций. Нажмите, чтобы посмотреть.': [
        'Скрыты {n} станций. Нажмите, чтобы посмотреть.',
        'Hidden {n} stations. Click to view.',
        '隱藏 {n} 車站。點擊查看',
        '{n} станциялар жасырылған. Қарау үшін басыңыз.'
    ],
    'Нажмите, чтобы скрыть': [
        'Нажмите, чтобы скрыть',
        'Click to hide',
        '點擊隱藏',
        'Жасыру үшін басыңыз'
    ]
};

/**
 * Получает оригинальный (ключевой) текст станции по переводу.
 * @param {string} translatedText - Переведённый текст станции.
 * @returns {string} Оригинальное имя станции или переданный текст, если не найдено совпадений.
 */
function getOriginalText(translatedText) {
    for (const key in stations) {
        const translations = stations[key];
        if (translations.includes(translatedText)) {
            return key;
        }
    }
    return translatedText;
}

/**
 * Переводит оригинальный текст на текущий язык.
 * Поддерживает шаблоны с подстановкой {n}.
 * @param {string} originalText - Оригинальный текст (ключ).
 * @returns {string} Переведённый текст, если найден; иначе возвращает оригинал.
 */
function translateText(originalText) {
    const translation = stations[originalText];
    if (translation) {
        return translation[currentLangIndex];
    }

    for (const key in stations) {
        if (key.includes('{n}')) {
            const regex = new RegExp('^' + key.replace('{n}', '(\\d+)') + '$');
            const match = originalText.match(regex);

            if (match) {
                const n = match[1];
                const template = stations[key][currentLangIndex];
                return template.replace('{n}', n);
            }
        }
    }
    return originalText;
}

/**
 * Переводит элементы callout на текущий язык.
 * Сохраняет оригинальный текст в `el._original` при первом вызове.
 */
function translateCalloutText() {
    const callout = document.querySelector('.callout');
    if (!callout) return;

    callout.querySelectorAll('.callout__from, .callout__to, .callout__header-title, .callout__header-info').forEach(el => {
        const original = el.textContent.trim();

        // Первый раз сохраняем оригинал
        if (!el._original) {
            el._original = original;
        }

        const translated = translateText(el._original);
        el.textContent = translated;
    });
}

/**
 * Обработчик, запускающийся при полной загрузке DOM.
 * Отвечает за перевод текста на странице при смене языка через селектор.
 */
document.addEventListener('DOMContentLoaded', function () {
    const languageSelector = document.getElementById('languageSelector');

    /**
     * Обновляет язык отображения текста на странице.
     * Проходит по DOM-элементам и заменяет текст на соответствующий перевод.
     * Сохраняет оригинальный текст элемента в свойство `_original`, чтобы не терять начальное значение.
     */
    function changeLanguage() {
        currentLangIndex = languageSelector.selectedIndex;
        // console.log("changing language to index:", currentLangIndex);

        document.querySelectorAll("*").forEach(element => {
            if (element.children.length === 0 && element.textContent.trim() !== "") {
                // Сохраняем оригинальный текст (только один раз)
                if (!element._original) {
                    element._original = element.textContent.trim();
                }

                const originalText = element._original;
                const translation = stations[originalText];

                if (translation) {
                    element.textContent = translation[currentLangIndex];
                } else {
                    // console.log("Нет перевода для:", originalText);
                }
            }
        });

        // Отдельная обработка для определённых HTML-элементов
        document.querySelectorAll("button, span, div, h1, h2, h3, h4, p, label").forEach(element => {
            if (element.children.length === 0 && element.textContent.trim() !== "") {
                const currentText = element.textContent.trim();

                if (!element._original) {
                    element._original = currentText;
                }

                const originalText = element._original;
                const translation = stations[originalText];

                if (translation) {
                    element.textContent = translation[currentLangIndex];
                }
            }
        });

        // Отдельная обработка SVG-текста
        document.querySelectorAll("text, tspan").forEach(element => {
            if (element.children.length === 0 && element.textContent.trim() !== "") {
                if (!element._original) {
                    element._original = element.textContent.trim();
                }

                const originalText = element._original;
                const translation = stations[originalText];

                if (translation) {
                    element.textContent = translation[currentLangIndex];
                }
            }
        });
    }

    // Назначаем обработчик смены языка
    languageSelector.addEventListener("change", changeLanguage);

    // Инициируем начальную установку языка
    changeLanguage();
})

/**
 * Хранилище для исходных цветов элементов SVG.
 * Используется Map, где ключ — DOM-элемент, а значение — объект с fill и stroke.
 * @type {Map<Element, {fill: string|null, stroke: string|null}>}
 */
const originalColors = new Map();

/**
 * Сохраняет исходные значения атрибутов `fill` и `stroke` для всех SVG-элементов,
 * находящихся в `.map__library > html > body > svg`.
 * Это позволяет позже восстановить цвета, если они были изменены.
 */
function saveOriginalColors() {
    const librarySvg = document.querySelector('.map__library > html > body > svg');
    if (!librarySvg) return;

    // Найти все элементы внутри SVG
    const elements = librarySvg.querySelectorAll('line, circle, path, rect, polygon, polyline, ellipse');
    elements.forEach(el => {
        if (!originalColors.has(el)) {
            originalColors.set(el, {
                fill: el.getAttribute('fill'),
                stroke: el.getAttribute('stroke')
            });
        }
    });
}

/**
 * Проверяет текущий фон карты и меняет цвета элементов SVG в зависимости от него.
 * — Если фон чёрный, то все элементы перекрашиваются в чёрный цвет.
 * — Если фон стандартный — возвращаются сохранённые цвета.
 * Также окрашивает блоки `departureImage` и `arrivalImage` в чёрный, если нужно.
 */
function checkMapBackground() {
    // Получаем div с id="map-background"
    const mapBackground = document.getElementById('map-background');
    if (!mapBackground) return;

    // Проверяем, какой фон установлен
    const backgroundStyle = mapBackground.style.background;

    const isBlackMap = backgroundStyle.includes('/map/new_map_black.png?v=23');
    const isDefaultMap = backgroundStyle.includes('/map/new_map.png?v=23');

    // Находим SVG в .map__library > html > body > svg
    const librarySvg = document.querySelector('.map__library > html > body > svg');
    if (!librarySvg) return;

    // Находим все элементы внутри SVG
    const elements = librarySvg.querySelectorAll('line, circle, path, rect, polygon, polyline, ellipse');

    elements.forEach(el => {
        if (isBlackMap) {
                    // Проверка для departureImage
        const departureImage = document.getElementById('departureImage');
        if (departureImage) {
            const departureStyle = getComputedStyle(departureImage);
            if (departureStyle.backgroundColor !== 'rgba(0, 0, 0, 0)' && departureStyle.backgroundColor !== 'transparent') {
                departureImage.style.backgroundColor = 'black';
                // console.log('Элемент departureImage окрашен в чёрный.');
            } else {
                console.log('Фон у departureImage отсутствует, изменений нет.');
            }
        }

        // Проверка для arrivalImage
        const arrivalImage = document.getElementById('arrivalImage');
        if (arrivalImage) {
            const arrivalStyle = getComputedStyle(arrivalImage);
            if (arrivalStyle.backgroundColor !== 'rgba(0, 0, 0, 0)' && arrivalStyle.backgroundColor !== 'transparent') {
                arrivalImage.style.backgroundColor = 'black';
                // console.log('Элемент arrivalImage окрашен в чёрный.');
            } else {
                console.log('Фон у arrivalImage отсутствует, изменений нет.');
            }
        }
            el.setAttribute('fill', 'black');
            el.setAttribute('stroke', 'black');
        } else if (isDefaultMap) {
            // Восстанавливаем исходные цвета
            const original = originalColors.get(el);
            if (original) {
                el.setAttribute('fill', original.fill || 'none');
                el.setAttribute('stroke', original.stroke || 'none');
            }
        }
    });
}

// Сохраняем исходные цвета при загрузке страницы
saveOriginalColors();

/**
 * Запускает периодическую проверку карты:
 * — сохраняет оригинальные цвета,
 * — изменяет текущие цвета в зависимости от фона.
 */
setInterval(() => {
    saveOriginalColors(); // Обновляем данные о цветах
    checkMapBackground(); // Проверяем фон и красим
}, 1000);

/**
 * Хэш последнего отрисованного маршрута (для избежания повторной отрисовки).
 * @type {string|null}
 */
let lastRouteHash = null;

/**
 * Индекс последнего выбранного языка (для отслеживания изменений языка).
 * @type {number|null}
 */
let lastLangIndex = null;

/**
 * Проверяет, загружены ли данные маршрута и требуется ли перерисовка маршрута.
 * Если маршрут изменился или сменился язык, а также активен нужный класс,
 * то вызывается функция `Rar()` с актуализированными данными.
 */
function checkAndRunRar() {
    if (!window.routeData || window.routeData.length === 0) {
        console.warn('❗ routeData ещё не загружен, ждем...');
        return;
    }

    const fixedRouteData = fixColors(window.routeData);
    const currentRouteHash = JSON.stringify(fixedRouteData);

    const languageSelector = document.getElementById('languageSelector');
    const currentLangIndex = languageSelector ? languageSelector.selectedIndex : 0;

    const mapRouteDiv = document.getElementById('map-route');
    const pip = document.querySelector('.pip');

    const shouldRedraw = currentRouteHash !== lastRouteHash || currentLangIndex !== lastLangIndex;

    if (shouldRedraw && pip.classList.contains('new_class') && mapRouteDiv) {
        lastRouteHash = currentRouteHash;
        lastLangIndex = currentLangIndex;

        Rar(fixedRouteData);
    }
}

/**
 * Создаёт глубокую копию маршрута и ищет первые две станции с ненулевыми названиями.
 * Пока не производит дополнительных манипуляций с цветами, но зарезервирован для этого.
 *
 * @param {Array<Object>} routeData - Список точек маршрута (объекты со свойствами, включая `name`)
 * @returns {Array<Object>} - Копия маршрута без изменений
 */
function fixColors(routeData) {
    let newRouteData = JSON.parse(JSON.stringify(routeData));

    let firstIdx = null, secondIdx = null;

    for (let i = 0; i < newRouteData.length; i++) {
        if (newRouteData[i].name !== null) {
            if (firstIdx === null) {
                firstIdx = i;
            } else {
                secondIdx = i;
                break
            }
        }
    }

    return newRouteData;
}

/**
 * Основная функция для визуализации маршрута на SVG-карте.
 * Отрисовывает станции, соединительные линии (в т.ч. градиентные и пунктирные),
 * текстовые метки, а также обрабатывает коллизии и всплывающие окна для скрытых групп станций.
 *
 * @param {Array<Object>} routeData - Массив объектов маршрута, включающий станции и линии.
 * @param {Array<Object>|null} existingGroups - Массив уже созданных групп станций (если повторный рендер), или null при первом вызове.
 */
function Rar(routeData, existingGroups = null) {

    if (!routeData) {
        console.error("globalRouteData is null or undefined");
        return; // Выходим из функции, если данных нет
    }

    var pip = document.querySelector('.pip');
    pip.classList.add('new_class');
    // console.log('Класс добавлен: new_class');
    // Показываем контейнер для рисования
    document.getElementById("div_open").style.display = "flex";
    document.getElementById("pip").style.display = "block";

    document.getElementById('pip'). innerHTML = '';

    const svgNS = "http://www.w3.org/2000/svg";
    const svg = document.createElementNS(svgNS, 'svg');
    svg.setAttribute("class", "svg_pion");
    const pipWidth = document.getElementById('pip').offsetWidth;
    const pipHeight = document.getElementById('pip').offsetHeight;
    svg.setAttribute("viewBox", `0 0 ${pipWidth} ${pipHeight}`)
    svg.setAttribute("preserveAspectRatio", "xMidYMid meet");

    const defs = document.createElementNS(svgNS, 'defs');
    svg.appendChild(defs);

    const startX = pipWidth * 0.05;
    const startY = pipHeight - (pipHeight * 0.65);
    const totalWidth = pipWidth - (pipWidth * 0.1);

    const stations = routeData.filter(item => item.type === 'station');

    /**
    * Отрисовывает станцию в виде круга.
    * @param {number} cx - Координата X.
    * @param {number} cy - Координата Y.
    * @param {string} fill - Цвет заливки.
    */
    function drawCircle(cx, cy, fill) {
        const circle = document.createElementNS(svgNS, 'circle');
        circle.setAttribute('cx', cx);
        circle.setAttribute('cy', cy);
        circle.setAttribute('fill', fill);
        circle.setAttribute('r', Math.max(10, pipWidth * 0.0015));
        circle.setAttribute('class', 'circle_svg');
        svg.appendChild(circle);
    }

    /**
     * Отрисовывает текст названия станции с автоматическим переносом строк.
     * @param {number} cx - Центр X.
     * @param {number} cy - Центр Y.
     * @param {string} textContent - Исходный текст (ключ станции).
     */
    function drawText(cx, cy, textContent) {
        const MAX_LENGTH = (currentLangIndex === 2) ? 8 : 16;
        const words = translateText(textContent).split(" ");
        let lines = [];

        let currentLine = '';
        words.forEach((word) => {
            if ((currentLine + "" + word).trim().length > MAX_LENGTH) {
                lines.push(currentLine.trim());
                currentLine = word;
            } else {
                currentLine += " " + word;
            }
        });
        lines.push(currentLine.trim());

        let finalLines = [];
        lines.forEach(line => {
            if (line.length > MAX_LENGTH) {
                const middle = Math.ceil(line.length / 2);
                const spaceIndex = line.lastIndexOf(" ", middle);
                if (spaceIndex !== -1) {
                    finalLines.push(line.slice(0, spaceIndex));
                    finalLines.push(line.slice(spaceIndex + 1));
                } else {
                    finalLines.push(line);
                }
            } else {
                finalLines.push(line);
            }
        });

        // Создаем элемент текста
        const textElement = document.createElementNS('http://www.w3.org/2000/svg', 'text');
        const lineHeight = 20;
        const baseY = cy - 20 - ((finalLines.length - 1) * lineHeight);
        textElement.setAttribute('x', cx);
        textElement.setAttribute('y', baseY); // Позиция по Y не меняется
        textElement.setAttribute('class', 'text_svg_station');
        textElement.setAttribute('text-anchor', 'middle');
        const adaptiveFontSize = Math.max(10, Math.min(25, pipWidth * 0.005));
        textElement.setAttribute('font-size', adaptiveFontSize + 'px');
        textElement.setAttribute('dominant-baseline', 'middle');

        finalLines.forEach((line, i) => {
            const tspan = document.createElementNS('http://www.w3.org/2000/svg', 'tspan');
            tspan.setAttribute('x', cx);
            tspan.setAttribute('y', baseY + i * lineHeight);
            tspan.textContent = line;
            textElement.appendChild(tspan);
        });

        svg.appendChild(textElement);
    }

    function adjustTextCollisions() {
        const texts = Array.from(document.querySelectorAll(".text_svg_station"));

        if (texts.length === 0) return;

        let previousEndX = -Infinity;
        let shouldRotateAll = false;

        // Первый проход — проверяем, есть ли хотя бы одна коллизия
        texts.forEach(text => {
            const bbox = text.getBBox();
            const currentX = parseFloat(text.getAttribute('x'));
            const currentStartX = currentX - bbox.width / 2;
            const currentEndX = currentX + bbox.width / 2;

            if (previousEndX >= currentStartX - 15) {
                shouldRotateAll = true; // Если хотя бы одна коллизия, поворачиваем всё
            }

            previousEndX = currentEndX;
        });

        // Если есть коллизии, разворачиваем все тексты
        if (shouldRotateAll) {
            texts.forEach(text => {
                const cx = parseFloat(text.getAttribute('x'));
                const cy = parseFloat(text.getAttribute('y'));

                const bbox = text.getBBox();

                // Новый x так, чтобы левый нижний угол текста оставался над кружком
                const newX = cx - bbox.width / 2;

                text.setAttribute('x', newX);
                text.setAttribute('text-anchor', 'start');

                const g = document.createElementNS('http://www.w3.org/2000/svg', 'g');
                g.setAttribute("transform", `rotate(-45 ${cx} ${cy})`);

                text.parentNode.replaceChild(g, text);
                g.appendChild(text);
            });
        }
    }

    /**
     * Отрисовывает линию между станциями (сплошную, пунктирную или градиентную).
     * @param {number} x1
     * @param {number} y1
     * @param {number} x2
     * @param {number} y2
     * @param {string} strokeColor - Цвет линии или url-путь к градиенту.
     * @param {string} startColor - Цвет начала градиента.
     * @param {string} endColor - Цвет конца градиента.
     */
    function drawLine(x1, y1, x2, y2, strokeColor, startColor, endColor) {
        const line = document.createElementNS(svgNS, "line");
        line.setAttribute("x1", x1);
        line.setAttribute("y1", y1);
        line.setAttribute("x2", x2);
        line.setAttribute("y2", y2);
        line.setAttribute("stroke-width", Math.max(6, pipWidth * 0.001));
        line.setAttribute("stroke-linecap", "round");
        line.setAttribute("stroke-opacity", "1");

        if (strokeColor === "#ACACAC") {
            drawDottedLine(x1, y1, x2, y2, "#ACACAC");
        } else if (strokeColor.startsWith("url(#") || (strokeColor === "white")) {
            drawGradientLine(x1, y1, x2, y2, startColor, endColor, 50);
        } else {
            line.setAttribute("stroke", strokeColor);
        }
        // console.log("Градиенты в defs:", defs.innerHTML);
        svg.appendChild(line);
    }

    /**
     * Отрисовывает пунктирную линию между станциями.
     * @param {number} x1
     * @param {number} y1
     * @param {number} x2
     * @param {number} y2
     * @param {string} color - Цвет точек.
     */
    function drawDottedLine(x1, y1, x2, y2, color) {
        const segmentSpacing = Math.max(12, pipWidth * 0.002); // 8px диаметр + 8px отступ = 16px между центрами точек
        const radius = Math.max(4, pipWidth * 0.001); // Радиус точки (диаметр 8px)

        // Вычисляем направление линии (вектор)
        const dx = x2 - x1;
        const dy = y2 - y1;
        const distance = Math.hypot(dx, dy); // Длина линии

        // Единичный вектор направления (нормализованный)
        const ux = dx / distance;
        const uy = dy / distance;

        // Смещаем начальную и конечную точку внутрь на 8 пикселей
        x1 += ux * 16;
        y1 += uy * 16;
        x2 -= ux * 16;
        y2 -= uy * 16;

        const newDistance = Math.hypot(x2 - x1, y2 - y1); // Новая длина линии
        const numDots = Math.floor(newDistance / segmentSpacing); // Количество точек

        for (let i = 0; i < numDots; i++) {
            const ratio = i / (numDots - 1);
            const cx = x1 + (x2 - x1) * ratio; // Интерполяция X
            const cy = y1 + (y2 - y1) * ratio; // Интерполяция Y

            const dot = document.createElementNS("http://www.w3.org/2000/svg", "circle");
            dot.setAttribute("cx", cx);
            dot.setAttribute("cy", cy);
            dot.setAttribute("r", radius);
            dot.setAttribute("fill", color);
            svg.appendChild(dot);
        }
    }

    /**
     * Рисует отрезок градиентной линии между двумя точками.
     *
     * @param {number} x1 - Координата X начала.
     * @param {number} y1 - Координата Y начала.
     * @param {number} x2 - Координата X конца.
     * @param {number} y2 - Координата Y конца.
     * @param {string} startColor - Начальный цвет (hex, например "#FF0000").
     * @param {string} endColor - Конечный цвет (hex, например "#00FF00").
     * @param {number} [segments=50] - Количество отрезков для градиента.
     */
    function drawGradientLine(x1, y1, x2, y2, startColor, endColor, segments = 50) {
        let svgNS = "http://www.w3.org/2000/svg";

        for (let i = 0; i < segments; i++) {
            let ratio = i / (segments - 1);

            let r = Math.round(
                parseInt(startColor.substring(1, 3), 16) * (1 - ratio) +
                parseInt(endColor.substring(1, 3), 16) * ratio
            );
            let g = Math.round(
                parseInt(startColor.substring(3, 5), 16) * (1 - ratio) +
                parseInt(endColor.substring(3, 5), 16) * ratio
            );
            let b = Math.round(
                parseInt(startColor.substring(5, 7), 16) * (1 - ratio) +
                parseInt(endColor.substring(5, 7), 16) * ratio
            );

            let color = `rgb(${r},${g},${b})`;

            let xStart = x1 + (x2 - x1) * (i / segments);
            let yStart = y1 + (y2 - y1) * (i / segments);
            let xEnd = x1 + (x2 - x1) * ((i + 1) / segments);
            let yEnd = y1 + (y2 - y1) * ((i + 1) / segments);

            let line = document.createElementNS(svgNS, "line");
            line.setAttribute("x1", xStart);
            line.setAttribute("y1", yStart);
            line.setAttribute("x2", xEnd);
            line.setAttribute("y2", yEnd);
            line.setAttribute("stroke", color);
            line.setAttribute("stroke-width", Math.max(6, pipWidth * 0.001));
            line.setAttribute("stroke-linecap", "round");
            svg.appendChild(line);
        }
    }

    /**
     * Группирует станции по одинаковому цвету, чтобы затем сделать коллапс (сворачивание).
     * Используется при отрисовке маршрута.
     */
    let groupedStations = [];
    let currentGroup = [];

    stations.forEach((station, index) => {
        if (currentGroup.length === 0) {
            currentGroup.push(station);
        } else {
            if (station.color === currentGroup[0].color) {
                currentGroup.push(station);
            } else {
                groupedStations.push(currentGroup);
                currentGroup = [station];
            }
        }
    });
    if (currentGroup.length > 0) {
        groupedStations.push(currentGroup);
    }

    /**
     * Формирует список всех важных станций — одиночные или крайние из группы.
     */
    const importantStations = [];

    /**
     * Массив групп станций, которые можно свернуть.
     * Если переданы внешние (например, при повторной отрисовке), они переиспользуются.
     */
    let collapsibleGroups = existingGroups || [];

    groupedStations.forEach(group => {
        if (group.length === 1) {
                importantStations.push(group[0]);
            } else {
                if (!existingGroups && group.length > 2) {
                    collapsibleGroups.push({
                        start: group[0],
                        middle: group.slice(1, -1),
                        end: group[group.length - 1],
                        collapsed: true
                    });
                }
            importantStations.push(group[0]);
            importantStations.push(group[group.length - 1]);
        }
    });

    /**
     * Список станций, которые реально будут отображаться.
     * Например, при свёрнутых группах — только крайние.
     */
    let visibleStations = [];
    groupedStations.forEach(group => {
        if (group.length === 1) {
            visibleStations.push(group[0]);
        } else {
            const matchingGroup = collapsibleGroups.find(g => g.start.id === group[0].id);
            if (matchingGroup?.collapsed === false) {
                visibleStations.push(...group);
            } else {
                visibleStations.push(group[0], group[group.length - 1])
            }
        }
    })

    /**
     * Для каждой отображаемой станции рассчитываются координаты.
     * Эти координаты используются для размещения кругов, текста и линий.
     */
    const stationCoords = visibleStations.map((station, index) => {
        // console.log("visibleStations:", visibleStations.map(s => s.id));
        return {
            id: station.id,
            x: startX + index * (totalWidth / (importantStations.length - 1)),
            y: startY,
            color: station.color,
            name: station.name
        };
    });

    stationCoords.forEach(station => {
        drawCircle(station.x, station.y, station.color);
        drawText(station.x, station.y, station.name);
    });

    /**
     * Отрисовывает круг (станция), текст рядом с ней и соединительные линии между ними.
     * Для линий поддерживается обычная, градиентная и пунктирная отрисовка.
     */

    /**
     * Сопоставление свёрнутых групп по ключу "startId-endId".
     * Нужно, чтобы понять — является ли отрезок свёрнутым и показать подсказку.
     */
    const collapsedGroupMap = new Map();
    collapsibleGroups.forEach(group => {
        if (group.collapsed) {
            collapsedGroupMap.set(`${group.start.id}-${group.end.id}`, group);
        }
    });

    for (let i = 0; i < visibleStations.length - 1; i++) {
        const startStation = stationCoords[i];
        const endStation = stationCoords[i + 1];
        const fromId = visibleStations[i].id;
        const toId = visibleStations[i + 1].id;
        const fromParts = fromId.split('_');
        const toParts = toId.split('_');

        const variants = [
            `${fromId}-${toId}`,
            `${toId}-${fromId}`,
            ...(fromParts[0] === toParts[0] ? [
                `${fromParts[0]}_${fromParts[1]}-${toParts[1]}`,
                `${fromParts[0]}_${toParts[1]}-${fromParts[1]}`
            ] : [])
        ];
        // console.log('from:', fromId, typeof fromId, 'to:', toId, typeof toId);
        const lineItem = routeData.find(el =>
            el.type === 'line' && variants.includes(el.id)
        );

        const isCollapsed =
            collapsedGroupMap.has(`${startStation.id}-${endStation.id}`) ||
            collapsedGroupMap.has(`${endStation.id}-${startStation.id}`);

        // console.log("Пробуем найти линию между", startStation.id, "и", endStation.id, "=>", lineItem);

        /**
         * Для каждой пары видимых станций:
         * - находим lineItem (данные линии)
         * - проверяем, свёрнута ли группа между ними
         * - рисуем линию (обычную, градиентную или пунктирную)
         * - если линия между свёрнутыми станциями — добавляется интерактивная подсказка
         *   (с возможностью открыть popup со списком скрытых станций).
         */

        /**
         * Вспомогательная функция для показа/скрытия popup'а со скрытыми станциями между точками.
         *
         * @param {Object} startStation - Координаты первой станции.
         * @param {Object} endStation - Координаты второй станции.
         * @param {Object} group - Данные группы (start, end, middle[]).
         * @param {number} midX - Координата X центра между станциями.
         * @param {number} startY - Базовая координата Y.
         * @param {SVGForeignObjectElement} hintText - Элемент-подсказка, который скрывается при открытии popup.
         */
        function togglePopup(startStation, endStation, group, midX, startY, hintText) {
            const popupId = `popup-${startStation.id}-${endStation.id}`;
            const existingList = document.getElementById(popupId);

            // Если уже открыт — закрываем и возвращаем hintText обратно
            if (existingList) {
                const html = existingList.querySelector('div');
                if (!html) {
                    existingList.remove();
                    hintText.style.display = 'block';  // вернуть подсказку
                    return;
                }

                html.style.transform = 'scaleY(0)';
                html.style.maxHeight = '0';
                html.style.opacity = '0';

                setTimeout(() => {
                    existingList.remove();
                    hintText.style.display = 'block';
                }, 300);
                return;
            }

            const popup = document.createElementNS("http://www.w3.org/2000/svg", "foreignObject");
            popup.setAttribute('x', Math.min(svg.clientWidth - 120, Math.max(0, (startStation.x + endStation.x) / 2 - 50)));
            popup.setAttribute('y', startY + 15);
            popup.setAttribute('width', 120);
            popup.setAttribute('height', 150);
            popup.setAttribute('id', popupId);

            const adaptiveFontSize = Math.max(10, Math.min(25, pipWidth * 0.005));

            const html = document.createElement('div');
            html.setAttribute('xmlns', 'http://www.w3.org/1999/xhtml');
            html.style.background = "#f0f0f0";
            html.style.display = 'inline-block';
            html.style.width = 'auto';
            html.style.border = "1px solid #ccc";
            html.style.borderRadius = "6px";
            html.style.padding = "5px";
            html.style.fontSize = adaptiveFontSize + 'px';
            html.style.maxHeight = "0";
            html.style.transformOrigin = 'top center';
            html.style.transform = 'scaleY(0)';
            html.style.transition = 'transform 0.3s ease, max-height 0.3s ease, opacity 0.3s ease';
            html.style.opacity = '0';
            html.style.fontFamily = "Arial, sans-serif";

            const scrollContainer = document.createElement('div');
            scrollContainer.style.display = 'inline-block';
            scrollContainer.style.overflowX = 'hidden';
            scrollContainer.style.maxHeight = '73px';
            scrollContainer.style.overflowY = 'auto';
            scrollContainer.style.webkitOverflowScrolling = 'touch';
            scrollContainer.style.paddingRight = '4px';

            group.middle.forEach(station => {
                const item = document.createElement('div');
                item.style.display = 'flex';
                item.style.alignItems = 'center';
                item.style.marginBottom = '4px';
                item.style.whiteSpace = 'nowrap';
                item.style.background = 'transparent';
                item.style.width = 'max-content';

                const dot = document.createElement('span');
                dot.style.display = 'inline-block';
                dot.style.width = '10px';
                dot.style.height = '10px';
                dot.style.borderRadius = '50%';
                dot.style.marginRight = '6px';
                dot.style.backgroundColor = station.color;
                item.appendChild(dot);

                const text = document.createElement('span');
                text.textContent = translateText(station.name);
                item.appendChild(text);

                scrollContainer.appendChild(item)
            });

            const closeHint = document.createElement('div');

            closeHint.setAttribute('xmlns', 'http://www.w3.org/1999/xhtml');
            closeHint.style.textAlign = 'center';
            closeHint.style.fontSize = adaptiveFontSize + 'px';
            closeHint.style.color = '#666';
            closeHint.style.marginBottom = '5px';
            closeHint.style.userSelect = 'none';
            closeHint.style.fontFamily = 'Arial, sans-serif';
            closeHint.innerText = translateText("Нажмите, чтобы скрыть");
            closeHint.addEventListener('click', () => togglePopup(startStation, endStation, group, midX, startY, hintText));

            html.insertBefore(closeHint, html.firstChild);

            html.appendChild(scrollContainer);
            popup.appendChild(html);
            svg.appendChild(popup);

            hintText.style.display = 'none';

            requestAnimationFrame(() => {
                const width = scrollContainer.scrollWidth + 10;
                const height = html.scrollHeight + 10;

                popup.setAttribute('width', width);
                popup.setAttribute('x', Math.max(0, midX - width / 2));
                popup.setAttribute('height', height);

                html.style.maxHeight = height + 'px';
                html.style.transform = 'scaleY(1)';
                html.style.opacity = '1';
            });
        }

        if (isCollapsed) {
            const midX = (startStation.x + endStation.x) / 2;
            const color = startStation.color;
            const gap = 25;

            const group = collapsedGroupMap.get(`${startStation.id}-${endStation.id}`) ||
                collapsedGroupMap.get(`${endStation.id}-${startStation.id}`);
            if (!group) return;

            drawLine(startStation.x, startStation.y, midX - gap, endStation.y, color, color, color);
            drawLine(midX + gap, startStation.y, endStation.x, endStation.y, color, color, color);

            const dotSpacing = 10;
            for (let j = -1; j <= 1; j++) {
                const dot = document.createElementNS(svgNS, "circle");
                dot.setAttribute("cx", midX + j * dotSpacing);
                dot.setAttribute("cy", startY);
                dot.setAttribute("r", 4);
                dot.setAttribute("fill", color);
                svg.appendChild(dot);
            }

            const hintText = document.createElementNS(svgNS, 'foreignObject');
            hintText.setAttribute('x', midX - 60);
            hintText.setAttribute('y', startY + 10);
            hintText.setAttribute('width', 120);
            hintText.setAttribute('height', 40);
            hintText.setAttribute('style', 'pointer-events: auto; cursor: pointer');

            function getStationText(count) {
                if (count % 10 === 1 && count % 100 !== 11) return 'станция';
                if ([2, 3, 4].includes(count % 10) && ![12, 13, 14].includes(count % 100)) return 'станции';
                return 'станций';
            }

            function getHiddenPrefix(count) {
                if (count % 10 === 1 && count % 100 !== 11) return 'Скрыта';
                return 'Скрыты';
            }

            const hintDiv = document.createElement('div');
            hintDiv.setAttribute('xmlns', 'http://www.w3.org/1999/xhtml');
            hintDiv.style.textAlign = 'center';
            hintDiv.style.color = '#666';
            hintDiv.style.fontFamily = 'Arial, sans-serif';
            const adaptiveFontSize = Math.max(10, Math.min(25, pipWidth * 0.005));
            hintDiv.style.fontSize = adaptiveFontSize + 'px';
            hintDiv.style.userSelect = 'none';
            hintDiv.style.pointerEvents = 'auto';
            hintDiv.style.whiteSpace = 'normal';
            hintDiv.style.wordBreak = 'break-word';
            hintDiv.style.lineHeight = '1.2';

            const stationCount = group.middle.length;
            const stationWord = getStationText(stationCount);
            const hiddenPrefix = getHiddenPrefix(stationCount);

            const sentencePart = `${hiddenPrefix} {n} ${stationWord}`;
            const originalTemplate = `${sentencePart}. Нажмите, чтобы посмотреть.`;

            hintDiv._original = originalTemplate.replace('{n}', stationCount);
            hintDiv.dataset.count = stationCount;

            const translatedText = translateText(hintDiv._original);
            hintDiv.innerHTML = translatedText;

            hintText.appendChild(hintDiv);
            svg.appendChild(hintText);

            const hotspot = document.createElementNS(svgNS, 'rect');
            hotspot.setAttribute('x', midX - 25);
            hotspot.setAttribute('y', startY - 20);
            hotspot.setAttribute('width', 50);
            hotspot.setAttribute('height', 40);
            hotspot.setAttribute('fill', 'transparent');
            hotspot.setAttribute('cursor', 'pointer');

            hotspot.addEventListener('click', () => togglePopup(startStation, endStation, group, midX, startY, hintText));
            hintText.addEventListener('click', () => togglePopup(startStation, endStation, group, midX, startY, hintText));

            svg.appendChild(hotspot);
        } else if (lineItem) {
            if (lineItem.color === 'white' || lineItem.color.startsWith('url(')) {
                drawGradientLine(startStation.x, startStation.y, endStation.x, endStation.y,
                    startStation.color, endStation.color);
            } else if (lineItem.color === '#ACACAC') {
                drawDottedLine(startStation.x, startStation.y, endStation.x, endStation.y,
                    lineItem.color);
            } else {
                drawLine(startStation.x, startStation.y, endStation.x, endStation.y,
                    startStation.color, endStation.color);
            }
        }
    }

    /**
     * Если группа не свёрнута — рисуем прозрачную кнопку,
     * по нажатию на которую пересоздаём маршрут с раскрытием группы.
     */
    for (let group of collapsibleGroups) {
        const start = stationCoords.find(s => s.id === group.start.id);
        const end = stationCoords.find(s => s.id === group.end.id);
        if (!start || !end) continue;

        if (!group.collapsed) {
            const button = document.createElementNS(svgNS, 'rect');
            button.setAttribute('x', Math.min(start.x, end.x));
            button.setAttribute('y', start.y - 20);
            button.setAttribute('width', Math.abs(end.x - start.x));
            button.setAttribute('height', 40);
            button.setAttribute('fill', 'transparent');
            button.setAttribute('cursor', 'pointer');

            button.addEventListener('click', () => {
                // console.log("2Before expand:", group);
                group.collapsed = !group.collapsed;
                // console.log("2After expand:", group);
                Rar(routeData, collapsibleGroups);
            });
            svg.appendChild(button);
        }
    }

    /**
     * Вставляем итоговый SVG в контейнер и запускаем логику для избежания наложений текста.
     */
    document.getElementById('pip').appendChild(svg);
    adjustTextCollisions();
}

// var metroLines  = [
//     {
//         'line': 'Сокольническая линия',
//         'color': 'cf2028',
//         'stations': [
//             { stations: ['Бульвар Рокоссовского', 'Черкизовская'], time: 2 },
//             { stations: ['Черкизовская', 'Преображенская площадь'], time: 3 },
//             { stations: ['Преображенская площадь', 'Сокольники'], time: 3 },
//             { stations: ['Сокольники', 'Красносельская'], time: 1 },
//             { stations: ['Красносельская', 'Комсомольская'], time: 1 },
//             { stations: ['Комсомольская', 'Красные ворота'], time: 1 },
//             { stations: ['Красные ворота', 'Чистые пруды'], time: 1 },
//             { stations: ['Чистые пруды', 'Лубянка'], time: 1 },
//             { stations: ['Лубянка', 'Охотный ряд'], time: 1 },
//             { stations: ['Охотный ряд', 'Библиотека имени Ленина'], time: 1 },
//             { stations: ['Библиотека имени Ленина', 'Кропоткинская'], time: 1 },
//             { stations: ['Кропоткинская', 'Парк культуры'], time: 2 },
//             { stations: ['Парк культуры', 'Фрунзенская'], time: 2 },
//             { stations: ['Фрунзенская', 'Спортивная'], time: 1 },
//             { stations: ['Спортивная', 'Воробьёвы горы'], time: 3 },
//             { stations: ['Воробьёвы горы', 'Университет'], time: 4 },
//             { stations: ['Университет', 'Проспект Вернадского'], time: 2 },
//             { stations: ['Проспект Вернадского', 'Юго-Западная'], time: 2 },
//             { stations: ['Юго-Западная', 'Тропарёво'], time: 3 },
//             { stations: ['Тропарёво', 'Румянцево'], time: 3 },
//             { stations: ['Румянцево', 'Саларьево'], time: 3 },
//             { stations: ['Саларьево', 'Филатов Луг'], time: 3 },
//             { stations: ['Филатов Луг', 'Прокшино'], time: 2 },
//             { stations: ['Прокшино', 'Ольховая'], time: 3 },
//             { stations: ['Ольховая', 'Коммунарка'], time: 1 }
//         ]
//     },
//     {
//         'line': 'Замоскворецкая линия',
//         'color': '13703a',
//         'stations': [
//             { stations: ['Алма-Атинская', 'Красногвардейская'], time: 4 },
//             { stations: ['Красногвардейская', 'Домодедовская'], time: 2 },
//             { stations: ['Домодедовская', 'Орехово'], time: 2 },
//             { stations: ['Орехово', 'Царицыно'], time: 2 },
//             { stations: ['Царицыно', 'Кантемировская'], time: 2 },
//             { stations: ['Кантемировская', 'Каширская'], time: 3 },
//             { stations: ['Каширская', 'Коломенская'], time: 3 },
//             { stations: ['Коломенская', 'Технопарк'], time: 2 },
//             { stations: ['Технопарк', 'Автозаводская'], time: 2 },
//             { stations: ['Автозаводская', 'Павелецкая'], time: 3 },
//             { stations: ['Павелецкая', 'Новокузнецкая'], time: 2 },
//             { stations: ['Новокузнецкая', 'Театральная'], time: 2 },
//             { stations: ['Театральная', 'Тверская'], time: 2 },
//             { stations: ['Тверская', 'Маяковская'], time: 1 },
//             { stations: ['Маяковская', 'Белорусская'], time: 2 },
//             { stations: ['Белорусская', 'Динамо'], time: 2 },
//             { stations: ['Динамо', 'Аэропорт'], time: 2 },
//             { stations: ['Аэропорт', 'Сокол'], time: 2 },
//             { stations: ['Сокол', 'Войковская'], time: 2 },
//             { stations: ['Войковская', 'Водный стадион'], time: 3 },
//             { stations: ['Водный стадион', 'Речной вокзал'], time: 2 },
//             { stations: ['Речной вокзал', 'Беломорская'], time: 1 },
//             { stations: ['Беломорская', 'Ховрино'], time: 2 }
//         ]
//     },
//     {
//         'line': 'Арбатско-Покровская линия',
//         'color': '283981',
//         'stations': [
//             { stations: ['Щёлковская', 'Первомайская'], time: 2 },
//             { stations: ['Первомайская', 'Измайловская'], time: 3 },
//             { stations: ['Измайловская', 'Партизанская'], time: 3 },
//             { stations: ['Партизанская', 'Семёновская'], time: 2 },
//             { stations: ['Семёновская', 'Электрозаводская'], time: 1 },
//             { stations: ['Электрозаводская', 'Бауманская'], time: 2 },
//             { stations: ['Бауманская', 'Курская'], time: 7 },
//             { stations: ['Курская', 'Площадь Революции'], time: 3 },
//             { stations: ['Площадь Революции', 'Арбатская'], time: 2 },
//             { stations: ['Арбатская', 'Смоленская'], time: 2 },
//             { stations: ['Смоленская', 'Киевская'], time: 5 },
//             { stations: ['Киевская', 'Парк Победы'], time: 8 },
//             { stations: ['Парк Победы', 'Славянский бульвар'], time: 4 },
//             { stations: ['Славянский бульвар', 'Кунцевская'], time: 2 },
//             { stations: ['Кунцевская', 'Молодёжная'], time: 3 },
//             { stations: ['Молодёжная', 'Крылатское'], time: 2 },
//             { stations: ['Крылатское', 'Строгино'], time: 8 },
//             { stations: ['Строгино', 'Мякинино'], time: 3 },
//             { stations: ['Мякинино', 'Волоколамская'], time:  2},
//             { stations: ['Волоколамская', 'Митино'], time: 3 },
//             { stations: ['Митино', 'Пятницкое шоссе'], time: 3 }
//         ]
//     },
//     {
//         'line': 'Филёвская линия',
//         'color': '19a2dc',
//         'stations': [
//             { stations: ['Кунцевская', 'Пионерская'], time: 1 },
//             { stations: ['Пионерская', 'Филевский парк'], time: 2 },
//             { stations: ['Филевский парк', 'Багратионовская'], time: 1 },
//             { stations: ['Багратионовская', 'Фили'], time: 2 },
//             { stations: ['Фили', 'Кутузовская'], time: 2 },
//             { stations: ['Кутузовская', 'Студенческая'], time:  2},
//             { stations: ['Студенческая', 'Киевская'], time: 2 },
//             { stations: ['Киевская', 'Площадь Смоленская'], time: 2 },
//             { stations: ['Площадь Смоленская', 'Арбатская'], time: 2 },
//             { stations: ['Арбатская', 'Александровский сад'], time: 1 }
//         ]
//     },
//     {
//     'line': 'Кольцевая линия',
//     'color': '8a3127',
//     'stations': [
//         { stations: ['Парк культуры', 'Октябрьская'], time: 2 },
//         { stations: ['Октябрьская', 'Добрынинская'], time: 2 },
//         { stations: ['Добрынинская', 'Павелецкая'], time: 1 },
//         { stations: ['Павелецкая', 'Таганская'], time: 1 },
//         { stations: ['Таганская', 'Курская'], time: 2 },
//         { stations: ['Курская', 'Комсомольская'], time: 2 },
//         { stations: ['Комсомольская', 'Проспект Мира'], time: 2 },
//         { stations: ['Проспект Мира', 'Новослободская'], time: 2 },
//         { stations: ['Новослободская', 'Белорусская'], time: 2 },
//         { stations: ['Белорусская', 'Краснопресненская'], time: 2 },
//         { stations: ['Краснопресненская', 'Киевская'], time: 2 },
//         { stations: ['Киевская', 'Парк культуры'], time: 2 }
//         ]
//     },
//         {
//         'line': 'Калужско-Рижская линия',
//         'color': 'f78e38',
//         'stations': [
//             { stations: ['Медведково', 'Бабушкинская'], time: 3 },
//             { stations: ['Бабушкинская', 'Свиблово'], time: 2 },
//             { stations: ['Свиблово', 'Ботанический сад'], time: 2 },
//             { stations: ['Ботанический сад', 'ВДНХ'], time: 3 },
//             { stations: ['ВДНХ', 'Алексеевская'], time: 2 },
//             { stations: ['Алексеевская', 'Рижская'], time: 2 },
//             { stations: ['Рижская', 'Проспект Мира'], time: 2 },
//             { stations: ['Проспект Мира', 'Сухаревская'], time: 2 },
//             { stations: ['Сухаревская', 'Тургеневская'], time: 1 },
//             { stations: ['Тургеневская', 'Китай-город'], time: 2 },
//             { stations: ['Китай-город', 'Третьяковская'], time: 2 },
//             { stations: ['Третьяковская', 'Октябрьская'], time: 2 },
//             { stations: ['Октябрьская', 'Шаболовская'], time: 2 },
//             { stations: ['Шаболовская', 'Ленинский проспект'], time: 2 },
//             { stations: ['Ленинский проспект', 'Академическая'], time: 2 },
//             { stations: ['Академическая', 'Профсоюзная'], time: 2 },
//             { stations: ['Профсоюзная', 'Новые Черёмушки'], time: 2 },
//             { stations: ['Новые Черёмушки', 'Калужская'], time: 2 },
//             { stations: ['Калужская', 'Беляево'], time: 3 },
//             { stations: ['Беляево', 'Коньково'], time: 2 },
//             { stations: ['Коньково', 'Тёплый стан'], time: 3 },
//             { stations: ['Тёплый стан', 'Ясенево'], time: 3 },
//             { stations: ['Ясенево', 'Новоясеневская'], time: 2 }
//         ]
//     },
//     {
//         'line': 'Таганско-Краснопресненская линия',
//         'color': 'a35d94',
//         'stations': [
//             { stations: ['Планерная', 'Сходненская'], time: 1 },
//             { stations: ['Сходненская', 'Тушинская'], time: 3 },
//             { stations: ['Тушинская', 'Спартак'], time: 1 },
//             { stations: ['Спартак', 'Щукинская'], time: 3 },
//             { stations: ['Щукинская', 'Октябрьское поле'], time:  3},
//             { stations: ['Октябрьское поле', 'Полежаевская'], time: 3 },
//             { stations: ['Полежаевская', 'Беговая'], time: 2 },
//             { stations: ['Беговая', 'Улица 1905 года'], time: 2 },
//             { stations: ['Улица 1905 года', 'Баррикадная'], time: 2 },
//             { stations: ['Баррикадная', 'Пушкинская'], time: 2 },
//             { stations: ['Пушкинская', 'Кузнецкий мост'], time: 1 },
//             { stations: ['Кузнецкий мост', 'Китай-город'], time: 1 },
//             { stations: ['Китай-город', 'Таганская'], time: 2 },
//             { stations: ['Таганская', 'Пролетарская'], time: 2 },
//             { stations: ['Пролетарская', 'Волгоградский проспект'], time: 2 },
//             { stations: ['Волгоградский проспект', 'Текстильщики'], time: 4 },
//             { stations: ['Текстильщики', 'Кузьминки'], time: 2 },
//             { stations: ['Кузьминки', 'Рязанский проспект'], time: 3 },
//             { stations: ['Рязанский проспект', 'Выхино'], time: 2 },
//             { stations: ['Выхино', 'Лермонтовский проспект'], time: 4 },
//             { stations: ['Лермонтовский проспект', 'Жулебино'], time: 2 },
//             { stations: ['Жулебино', 'Котельники'], time: 2 }
//         ]
//     },
//     {
//         'line': 'Калининская линия',
//         'color': 'fde34f',
//         'stations': [
//             { stations: ['Новокосино', 'Новогиреево'], time: 4 },
//             { stations: ['Новогиреево', 'Перово'], time: 2 },
//             { stations: ['Перово', 'Шоссе Энтузиастов'], time: 3 },
//             { stations: ['Шоссе Энтузиастов', 'Авиамоторная'], time: 2 },
//             { stations: ['Авиамоторная', 'Площадь Ильича'], time: 3 },
//             { stations: ['Площадь Ильича', 'Марксистская'], time: 2 },
//             { stations: ['Марксистская', 'Третьяковская'], time: 2 },
//         ]
//     },
//     {
//         'line': 'Солнцевская',
//         'color': 'fde34f',
//         'stations': [
//             { stations: ['Деловой центр', 'Парк Победы'], time: 4 },
//             { stations: ['Парк Победы', 'Минская'], time: 3 },
//             { stations: ['Минская', 'Ломоносовский проспект'], time: 3 },
//             { stations: ['Ломоносовский проспект', 'Раменки'], time: 2 },
//             { stations: ['Раменки', 'Мичуринский проспект'], time: 1 },
//             { stations: ['Мичуринский проспект', 'Озёрная'], time: 3 },
//             { stations: ['Озёрная', 'Говорово'], time: 2 },
//             { stations: ['Говорово', 'Солнцево'], time: 2 },
//             { stations: ['Солнцево', 'Боровское шоссе'], time: 3 },
//             { stations: ['Боровское шоссе', 'Новопеределкино'], time: 2 },
//             { stations: ['Новопеределкино', 'Рассказовка'], time: 1 },
//             { stations: ['Рассказовка', 'Пыхтино'], time: 2 },
//             { stations: ['Пыхтино', 'Аэропорт Внуково'], time: 3 }
//         ]
//     },
//     {
//         'line': 'Серпуховско-Тимирязевская линия',
//         'color': 'abaeba',
//         'stations': [
//             { stations: ['Алтуфьево', 'Бибирево'], time: 3 },
//             { stations: ['Бибирево', 'Отрадное'], time: 3 },
//             { stations: ['Отрадное', 'Владыкино'], time: 2 },
//             { stations: ['Владыкино', 'Петровско-Разумовская'], time: 2 },
//             { stations: ['Петровско-Разумовская', 'Тимирязевская'], time: 3 },
//             { stations: ['Тимирязевская', 'Дмитровская'], time: 1 },
//             { stations: ['Дмитровская', 'Савёловская'], time: 2 },
//             { stations: ['Савёловская', 'Менделеевская'], time: 2 },
//             { stations: ['Менделеевская', 'Цветной бульвар'], time: 2 },
//             { stations: ['Цветной бульвар', 'Чеховская'], time: 1 },
//             { stations: ['Чеховская', 'Боровицкая'], time: 2 },
//             { stations: ['Боровицкая', 'Полянка'], time: 2 },
//             { stations: ['Полянка', 'Серпуховская'], time: 2 },
//             { stations: ['Серпуховская', 'Тульская'], time: 3 },
//             { stations: ['Тульская', 'Нагатинская'], time: 4 },
//             { stations: ['Нагатинская', 'Нагорная'], time: 2 },
//             { stations: ['Нагорная', 'Нахимовский проспект'], time: 1 },
//             { stations: ['Нахимовский проспект', 'Севастопольская'], time: 1 },
//             { stations: ['Севастопольская', 'Чертановская'], time: 2 },
//             { stations: ['Чертановская', 'Южная'], time: 3 },
//             { stations: ['Южная', 'Пражская'], time: 1 },
//             { stations: ['Пражская', 'Улица академика Янгеля'], time: 2 },
//             { stations: ['Улица академика Янгеля', 'Аннино'], time: 2 },
//             { stations: ['Аннино', 'Бульвар Дмитрия Донского'], time: 2 }
//         ]
//     },
//     {
//         'line': 'Люблинско-Дмитровская линия',
//         'color': 'aad16e',
//         'stations': [
//             { stations: ['Физтех', 'Лианозово'], time: 3 },
//             { stations: ['Лианозово', 'Яхромская'], time: 2 },
//             { stations: ['Яхромская', 'Селигерская'], time: 2 },
//             { stations: ['Селигерская', 'Верхние Лихоборы'], time: 1 },
//             { stations: ['Верхние Лихоборы', 'Окружная'], time: 1 },
//             { stations: ['Окружная', 'Петровско-Разумовская'], time: 1 },
//             { stations: ['Петровско-Разумовская', 'Фонвизинская'], time: 4 },
//             { stations: ['Фонвизинская', 'Бутырская'], time: 2 },
//             { stations: ['Бутырская', 'Марьина роща'], time: 3 },
//             { stations: ['Марьина роща', 'Достоевская'], time: 3 },
//             { stations: ['Достоевская', 'Трубная'], time: 2 },
//             { stations: ['Трубная', 'Сретенский бульвар'], time: 2 },
//             { stations: ['Сретенский бульвар', 'Чкаловская'], time: 2 },
//             { stations: ['Чкаловская', 'Римская'], time: 2 },
//             { stations: ['Римская', 'Крестьянская застава'], time: 2 },
//             { stations: ['Крестьянская застава', 'Дубровка'], time: 2 },
//             { stations: ['Дубровка', 'Кожуховская'], time: 2 },
//             { stations: ['Кожуховская', 'Печатники'], time: 3 },
//             { stations: ['Печатники', 'Волжская'], time: 2 },
//             { stations: ['Волжская', 'Люблино'], time: 2 },
//             { stations: ['Люблино', 'Братиславская'], time: 2 },
//             { stations: ['Братиславская', 'Марьино'], time: 1 },
//             { stations: ['Марьино', 'Борисово'], time: 3 },
//             { stations: ['Борисово', 'Шипиловская'], time: 3 },
//             { stations: ['Шипиловская', 'Зябликово'], time: 3 }
//         ]
//     },
//     {
//         'line': 'Большая кольцевая',
//         'color': '1cb2a7',
//         'stations': [
//             { stations: ['Народное Ополчение', 'Мнёвники'], time: 3 },
//             { stations: ['Мнёвники', 'Терехово'], time: 2 },
//             { stations: ['Терехово', 'Кунцевская'], time: 3 },
//             { stations: ['Кунцевская', 'Давыдково'], time: 2 },
//             { stations: ['Давыдково', 'Аминьевская'], time: 3 },
//             { stations: ['Аминьевская', 'Мичуринский проспект'], time: 2 },
//             { stations: ['Мичуринский проспект', 'Проспект Вернадского'], time: 2 },
//             { stations: ['Проспект Вернадского', 'Новаторская'], time: 2 },
//             { stations: ['Новаторская', 'Воронцовская'], time: 2 },
//             { stations: ['Воронцовская', 'Зюзино'], time: 3 },
//             { stations: ['Зюзино', 'Каховская'], time: 2 },
//             { stations: ['Каховская', 'Варшавская'], time: 2 },
//             { stations: ['Варшавская', 'Каширская'], time: 3 },
//             { stations: ['Каширская', 'Кленовый бульвар'], time: 4 },
//             { stations: ['Кленовый бульвар', 'Нагатинский затон'], time: 2 },
//             { stations: ['Нагатинский затон', 'Печатники'], time: 2 },
//             { stations: ['Печатники', 'Текстильщики'], time: 2 },
//             { stations: ['Текстильщики', 'Нижегородская'], time: 4 },
//             { stations: ['Нижегородская', 'Авиамоторная'], time: 4 },
//             { stations: ['Авиамоторная', 'Лефортово'], time: 2 },
//             { stations: ['Лефортово', 'Электрозаводская'], time: 2 },
//             { stations: ['Электрозаводская', 'Сокольники'], time: 3 },
//             { stations: ['Сокольники', 'Рижская'], time: 4 },
//             { stations: ['Рижская', 'Марьина Роща'], time: 2 },
//             { stations: ['Марьина Роща', 'Савёловская'], time: 3 },
//             { stations: ['Савёловская', 'Петровский парк'], time: 3 },
//             { stations: ['Петровский парк', 'ЦСКА'], time: 2 },
//             { stations: ['ЦСКА', 'Хорошёвская'], time: 2 }
//         ]
//     },
//     {
//         'line': 'Бутовская линия',
//         'color': '8ec9ea',
//         'stations': [
//             { stations: ['Битцевский парк', 'Лесопарковая'], time: 3 },
//             { stations: ['Лесопарковая', 'Улица Старокачаловская'], time: 3 },
//             { stations: ['Улица Старокачаловская', 'Улица Скобелевская'], time: 5 },
//             { stations: ['Улица Скобелевская', 'Бульвар адмирала Ушакова'], time: 1 },
//             { stations: ['Бульвар адмирала Ушакова', 'Улица Горчакова'], time: 2 },
//             { stations: ['Улица Горчакова', 'Бунинская аллея'], time: 2 }
//         ]
//     },
//     {
//         'line': 'Московский монорельс',
//         'color': 'd68ab1',
//         'stations': [
//             { stations: ['Тимирязевская', 'Улица Милашенкова'], time: 2 },
//             { stations: ['Улица Милашенкова', 'Телецентр'], time: 2 },
//             { stations: ['Телецентр', 'Улица Академика Королёва'], time: 2 },
//             { stations: ['Улица Академика Королёва', 'Выставочный центр'], time: 2 },
//             { stations: ['Выставочный центр', 'Улица Сергея Эйзенштейна'], time: 2 }
//         ]
//     },
//     {
//         'line': 'Московское центральное кольцо',
//         'color': 'd68ab1',
//         'stations': [
//             { stations: ['Окружная', 'Владыкино'], time: 2 },
//             { stations: ['Владыкино', 'Ботанический сад'], time: 2 },
//             { stations: ['Ботанический сад', 'Ростокино'], time: 2 },
//             { stations: ['Ростокино', 'Белокаменная'], time: 2 },
//             { stations: ['Белокаменная', 'Бульвар Рокоссовского'], time: 2 },
//             { stations: ['Бульвар Рокоссовского', 'Локомотив'], time: 1 },
//             { stations: ['Локомотив', 'Измайлово'], time: 2 },
//             { stations: ['Измайлово', 'Соколиная Гора'], time: 3 },
//             { stations: ['Соколиная Гора', 'Шоссе Энтузиастов'], time: 2 },
//             { stations: ['Шоссе Энтузиастов', 'Андроновка'], time: 3 },
//             { stations: ['Андроновка', 'Нижегородская'], time: 2 },
//             { stations: ['Нижегородская', 'Новохохловская'], time: 2 },
//             { stations: ['Новохохловская', 'Угрешская'], time: 4 },
//             { stations: ['Угрешская', 'Дубровка'], time: 3 },
//             { stations: ['Дубровка', 'Автозаводская'], time: 1 },
//             { stations: ['Автозаводская', 'ЗИЛ'], time: 1 },
//             { stations: ['ЗИЛ', 'Верхние Котлы'], time: 2 },
//             { stations: ['Верхние Котлы', 'Крымская'], time: 2 },
//             { stations: ['Крымская', 'Площадь Гагарина'], time: 2 },
//             { stations: ['Площадь Гагарина', 'Лужники'], time: 2 },
//             { stations: ['Лужники', 'Кутузовская'], time: 5 },
//             { stations: ['Кутузовская', 'Москва-Сити'], time: 2 },
//             { stations: ['Москва-Сити', 'Шелепиха'], time: 1 },
//             { stations: ['Шелепиха', 'Хорошёво'], time: 2 },
//             { stations: ['Хорошёво', 'Зорге'], time: 1 },
//             { stations: ['Зорге', 'Панфиловская'], time: 2 },
//             { stations: ['Панфиловская', 'Стрешнево'], time: 1 },
//             { stations: ['Стрешнево', 'Балтийская'], time: 3 },
//             { stations: ['Балтийская', 'Коптево'], time: 2 },
//             { stations: ['Коптево', 'Лихоборы'], time: 2 }
//         ]
//     },
//     {
//         'line': 'Некрасовская линия',
//         'color': 'd68ab1',
//         'stations': [
//             { stations: ['Нижегородская', 'Стахановская'], time: 2 },
//             { stations: ['Стахановская', 'Окская'], time: 2 },
//             { stations: ['Окская', 'Юго-Восточная'], time: 3 },
//             { stations: ['Юго-Восточная', 'Косино'], time: 3 },
//             { stations: ['Косино', 'Улица Дмитриевского'], time: 3 },
//             { stations: ['Улица Дмитриевского', 'Лухмановская'], time: 2 },
//             { stations: ['Лухмановская', 'Некрасовка'], time: 2 }
//         ]
//     },
//     {
//         'line': 'Троицкая линия',
//         'color': 'd68ab1',
//         'stations': [
//             { stations: ['Новаторская', 'Университет дружбы народов'], time: 3 },
//             { stations: ['Университет дружбы народов', 'Генерала Тюленева'], time: 2 },
//             { stations: ['Генерала Тюленева', 'Тютчевская'], time: 3 },
//         ]
//     },
//     {
//         'line': 'Белорусско-Савёловский диаметр',
//         'color': 'd68ab1',
//         'stations': [
//             { stations: ['Одинцово', 'Баковка'], time: 5 },
//             { stations: ['Баковка', 'Сколково'], time: 3 },
//             { stations: ['Сколково', 'Немчиновка'], time: 3 },
//             { stations: ['Немчиновка', 'Сетунь'], time: 3 },
//             { stations: ['Сетунь', 'Рабочий Посёлок'], time: 2 },
//             { stations: ['Рабочий Посёлок', 'Кунцевская'], time: 2 },
//             { stations: ['Кунцевская', 'Славянский бульвар'], time: 3 },
//             { stations: ['Славянский бульвар', 'Фили'], time: 6 },
//             { stations: ['Фили', 'Москва-Сити'], time: 3 },
//             { stations: ['Москва-Сити', 'Беговая'], time: 3 },
//             { stations: ['Беговая', 'Белорусская'], time: 6 },
//             { stations: ['Белорусская', 'Савёловская'], time: 6 },
//             { stations: ['Савёловская', 'Тимирязевская'], time: 8 },
//             { stations: ['Тимирязевская', 'Окружная'], time: 6 },
//             { stations: ['Окружная', 'Дегунино'], time: 2 },
//             { stations: ['Дегунино', 'Бескудниково'], time: 4 },
//             { stations: ['Бескудниково', 'Илимская'], time: 2 },
//             { stations: ['Илимская', 'Лианозово'], time: 2 },
//             { stations: ['Лианозово', 'Марк'], time: 2 },
//             { stations: ['Марк', 'Новодачная'], time: 4 },
//             { stations: ['Новодачная', 'Долгопрудная'], time: 2 },
//             { stations: ['Долгопрудная', 'Водники'], time: 2 },
//             { stations: ['Водники', 'Хлебниково'], time: 3 },
//             { stations: ['Хлебниково', 'Шереметьевская'], time: 2 },
//             { stations: ['Шереметьевская', 'Лобня'], time: 5 }
//         ]
//     },
//     {
//         'line': 'Курско-Рижский диаметр',
//         'color': 'd68ab1',
//         'stations': [
//             { stations: ['Подольск', 'Силикатная'], time: 5 },
//             { stations: ['Силикатная', 'Остафьево'], time: 2 },
//             { stations: ['Остафьево', 'Щербинка'], time: 2 },
//             { stations: ['Щербинка', 'Бутово'], time: 3 },
//             { stations: ['Бутово', 'Новая Битца'], time: 4 },
//             { stations: ['Новая Битца', 'Битца'], time: 2 },
//             { stations: ['Битца', 'Красный Строитель'], time: 3 },
//             { stations: ['Красный Строитель', 'Покровское'], time: 3 },
//             { stations: ['Покровское', 'Котляково'], time: 2 },
//             { stations: ['Котляково', 'Царицыно'], time: 3 },
//             { stations: ['Царицыно', 'Москворечье'], time: 4 },
//             { stations: ['Москворечье', 'Курьяново'], time: 2 },
//             { stations: ['Курьяново', 'Перерва'], time: 2 },
//             { stations: ['Перерва', 'Депо'], time: 2 },
//             { stations: ['Депо', 'Люблино'], time: 2 },
//             { stations: ['Люблино', 'Печатники'], time: 3 },
//             { stations: ['Печатники', 'Текстильщики'], time: 3 },
//             { stations: ['Текстильщики', 'Новохохловская'], time: 2 },
//             { stations: ['Новохохловская', 'Калитники'], time: 2 },
//             { stations: ['Калитники', 'Москва Товарная'], time: 2 },
//             { stations: ['Москва Товарная', 'Курская'], time: 3 },
//             { stations: ['Курская', 'Площадь трёх вокзалов'], time: 6 },
//             { stations: ['Площадь трёх вокзалов', 'Рижская'], time: 5 },
//             { stations: ['Рижская', 'Марьина Роща'], time: 4 },
//             { stations: ['Марьина Роща', 'Дмитровская'], time: 6 },
//             { stations: ['Дмитровская', 'Гражданская'], time: 2 },
//             { stations: ['Гражданская', 'Красный Балтиец'], time: 3 },
//             { stations: ['Текстильщики', 'Стрешнево'], time: 3 },
//             { stations: ['Новохохловская', 'Щукинская'], time: 2 },
//             { stations: ['Калитники', 'Тушинская'], time: 5 },
//             { stations: ['Москва Товарная', 'Трикотажная'], time: 3 },
//             { stations: ['Курская', 'Волоколамская '], time: 6 },
//             { stations: ['Площадь трёх вокзалов', 'Пенягино'], time: 4 },
//             { stations: ['Рижская', 'Павшино'], time: 2 },
//             { stations: ['Марьина Роща', 'Красногорская'], time: 2 },
//             { stations: ['Дмитровская', 'Опалиха'], time: 2 },
//             { stations: ['Гражданская', 'Аникеевкая'], time: 3 },
//             { stations: ['Площадь трёх вокзалов', 'Нахабино'], time: 4 },
//         ]
//     },
//     {
//         'line': 'Ленинградско-Казанский диаметр',
//         'color': '1cb2a7',
//         'stations': [
//             { stations: ['Зеленоград-Крюково', 'Фирсановская'], time: 9 },
//             { stations: ['Фирсановская', 'Сходня'], time: 4 },
//             { stations: ['Сходня', 'Подрезково'], time: 3 },
//             { stations: ['Подрезково', 'Новоподрезково'], time: 2 },
//             { stations: ['Новоподрезково', 'Молжаниново'], time: 3 },
//             { stations: ['Молжаниново', 'Химки'], time: 5 },
//             { stations: ['Химки', 'Левобережная'], time: 2 },
//             { stations: ['Левобережная', 'Ховрина'], time: 2 },
//             { stations: ['Ховрина', 'Грачёвская'], time: 3 },
//             { stations: ['Грачёвская', 'Моссельмаш'], time: 2 },
//             { stations: ['Моссельмаш', 'Лихоборы'], time: 3 },
//             { stations: ['Лихоборы', 'Петровско-Разумовская'], time: 7 },
//             { stations: ['Петровско-Разумовская', 'Останкино'], time: 5 },
//             { stations: ['Останкино', 'Матьково'], time: 16 },
//             { stations: ['Матьково', 'Электрозаводская'], time: 5 },
//             { stations: ['Электрозаводская', 'Сортировочная'], time: 2 },
//             { stations: ['Сортировочная', 'Авиамоторная'], time: 3 },
//             { stations: ['Авиамоторная', 'Андроновка'], time: 3 },
//             { stations: ['Андроновка', 'Перово'], time: 3 },
//             { stations: ['Перово', 'Плющево'], time: 2 },
//             { stations: ['Плющево', 'Вешняки'], time: 3 },
//             { stations: ['Вешняки', 'Выхино'], time: 2 },
//             { stations: ['Выхино', 'Косино'], time: 3 },
//             { stations: ['Косино', 'Ухтомская'], time: 2 },
//             { stations: ['Ухтомская', 'Люберцы'], time: 4 },
//             { stations: ['Люберцы', 'Панки'], time: 3 },
//             { stations: ['Панки', 'Томилино'], time: 3 },
//             { stations: ['Томилино', 'Красково'], time: 2 },
//             { stations: ['Красково', 'Малаховка'], time: 2 },
//             { stations: ['Малаховка', 'Удельная'], time: 3 },
//             { stations: ['Удельная', 'Быково'], time: 2 },
//             { stations: ['Быково', 'Ильинская'], time: 3 },
//             { stations: ['Ильинская', 'Отдых'], time: 3 },
//             { stations: ['Отдых', 'Кратово'], time: 3 },
//             { stations: ['Кратово', 'Есенинская'], time: 2 },
//             { stations: ['Есенинская', 'Фабричная'], time: 2 },
//             { stations: ['Фабричная', 'Ременское'], time: 2 },
//             { stations: ['Ременское', 'Ипподром'], time: 2 }
//         ]
//     },
//     {
//         'line': 'Калужско-Нижегородский диаметр',
//         'color': '1cb2a7',
//         'stations': [
//             { stations: ['Апрелевка', 'Победа'], time: 3 },
//             { stations: ['Победа', 'Крёкшино'], time: 3 },
//             { stations: ['Крёкшино', 'Санино'], time: 3 },
//             { stations: ['Санино', 'Кокошкино'], time: 3 },
//             { stations: ['Кокошкино', 'Толстопальцево'], time: 2 },
//             { stations: ['Толстопальцево', 'Лесной Городок'], time: 5 },
//             { stations: ['Лесной Городок', 'Внуково'], time: 4 },
//             { stations: ['Внуково', 'Мичуринец'], time: 3 },
//             { stations: ['Мичуринец', 'Переделкино'], time: 4 },
//             { stations: ['Переделкино', 'Солнечная'], time: 3 },
//             { stations: ['Солнечная', 'Мещерская'], time: 3 },
//             { stations: ['Мещерская', 'Очаково'], time: 3 },
//             { stations: ['Очаково', 'Аминьевская'], time: 3 },
//             { stations: ['Аминьевская', 'Матвеевская'], time: 3 },
//             { stations: ['Матвеевская', 'Минская'], time: 3 },
//             { stations: ['Минская', 'Поклонная'], time: 3 },
//             { stations: ['Поклонная', 'Кутузовская'], time: 3 },
//             { stations: ['Кутузовская', 'Москва-Сити'], time: 1 },
//             { stations: ['Москва-Сити', 'Белорусская'], time: 9 },
//             { stations: ['Белорусская', 'Савёловская'], time: 3 },
//             { stations: ['Савёловская', 'Марьина Роща'], time: 3 },
//             { stations: ['Марьина Роща', 'Площадь трёх вокзалов'], time: 6 },
//             { stations: ['Площадь трёх вокзалов', 'Курская'], time: 4 },
//             { stations: ['Курская', 'Серп и Молот'], time: 4 },
//             { stations: ['Серп и Молот', 'Нижегородская'], time: 5 },
//             { stations: ['Нижегородская', 'Чухлинка'], time: 3 },
//             { stations: ['Чухлинка', 'Кусково'], time: 3 },
//             { stations: ['Кусково', 'Новогиреево'], time: 3 },
//             { stations: ['Новогиреево', 'Реутов'], time: 3 },
//             { stations: ['Реутов', 'Никольское'], time: 4 },
//             { stations: ['Никольское', 'Салтыковская'], time: 3 },
//             { stations: ['Салтыковская', 'Кучино'], time: 3 },
//             { stations: ['Кучино', 'Ольгино'], time: 3 },
//             { stations: ['Ольгино', 'Железнодорожная'], time: 5 }
//         ]
// }
// ];
var metro = [
    {'line': 'Сокольническая линия', 'stations': ['Бульвар Рокоссовского', 'Черкизовская', 'Преображенская площадь', 'Сокольники', 'Красносельская', 'Комсомольская', 'Красные ворота', 'Чистые пруды', 'Лубянка', 'Охотный ряд', 'Библиотека имени Ленина', 'Кропоткинская', 'Парк культуры', 'Фрунзенская', 'Спортивная', 'Воробьёвы горы', 'Университет', 'Проспект Вернадского', 'Юго-Западная', 'Тропарёво', 'Румянцево', 'Саларьево', 'Филатов Луг', 'Прокшино', 'Ольховая', 'Новомосковская','Потапово'], 'color': 'cf2028'},
    {'line': 'Замоскворецкая линия', 'stations': ['Алма-Атинская', 'Красногвардейская', 'Домодедовская', 'Орехово', 'Царицыно', 'Кантемировская', 'Каширская', 'Коломенская', 'Технопарк', 'Автозаводская', 'Павелецкая', 'Новокузнецкая', 'Театральная', 'Тверская', 'Маяковская', 'Белорусская', 'Динамо', 'Аэропорт', 'Сокол', 'Войковская', 'Водный стадион', 'Речной вокзал', 'Беломорская', 'Ховрино'], 'color': '13703a'},
    {'line': 'Арбатско-Покровская линия', 'stations': ['Щёлковская', 'Первомайская', 'Измайлово', 'Партизанская', 'Семёновская', 'Электрозаводская', 'Бауманская', 'Курская', 'Площадь Революции', 'Арбатская', 'Смоленская', 'Киевская', 'Парк Победы', 'Славянский бульвар', 'Кунцевская', 'Молодёжная', 'Крылатское', 'Строгино', 'Мякинино', 'Волоколамская', 'Митино', 'Пятницкое шоссе'], 'color': '283981'},
    {'line': 'Филёвская линия', 'stations': ['Кунцевская', 'Пионерская', 'Филевский парк', 'Багратионовская', 'Фили', 'Кутузовская', 'Студенческая', 'Киевская', 'Смоленская', 'Арбатская', 'Александровский сад'], 'color': '19a2dc'},
    {'line': 'Кольцевая линия', 'stations': ['Парк культуры', 'Октябрьская', 'Добрынинская', 'Павелецкая', 'Таганская', 'Курская', 'Комсомольская', 'Проспект Мира', 'Новослободская', 'Белорусская', 'Краснопресненская', 'Киевская'], 'color': '8a3127'},
    {'line': 'Калужско-Рижская линия', 'stations': ['Медведково', 'Бабушкинская', 'Свиблово', 'Ботанический сад', 'ВДНХ', 'Алексеевская', 'Рижская', 'Проспект Мира', 'Сухаревская', 'Тургеневская', 'Китай-город', 'Третьяковская', 'Октябрьская', 'Шаболовская', 'Ленинский проспект', 'Академическая', 'Профсоюзная', 'Новые Черёмушки', 'Калужская', 'Беляево', 'Коньково', 'Тёплый стан', 'Ясенево', 'Новоясеневская'], 'color': 'f78e38'},
    {'line': 'Таганско-Краснопресненская линия', 'stations': ['Планерная', 'Сходненская', 'Тушинская', 'Спартак', 'Щукинская', 'Октябрьское поле', 'Полежаевская', 'Беговая', 'Улица 1905 года', 'Баррикадная', 'Пушкинская', 'Кузнецкий мост', 'Китай-город', 'Таганская', 'Пролетарская', 'Волгоградский проспект', 'Текстильщики', 'Кузьминки', 'Рязанский проспект', 'Выхино', 'Лермонтовский проспект', 'Жулебино', 'Котельники'], 'color': 'a35d94'},
    {'line': 'Калининская линия', 'stations': ['Новокосино', 'Новогиреево', 'Перово', 'Шоссе Энтузиастов', 'Авиамоторная', 'Площадь Ильича', 'Марксистская', 'Третьяковская', 'Парк Победы', 'Деловой центр', 'Минская', 'Ломоносовский проспект', 'Раменки'], 'color': 'fde34f'},
    {'line': 'Солнцевская', 'stations': ['Деловой центр', 'Парк Победы', 'Минская', 'Ломоносовский проспект', 'Мичуринский проспект', 'Озёрная', 'Говорово', 'Солнцево', 'Боровское шоссе', 'Новопеределкино', 'Рассказовка', 'Пыхтино', 'Аэропорт Внуково'], 'color': 'fde34f'},
    {'line': 'Серпуховско-Тимирязевская линия', 'stations': ['Алтуфьево', 'Бибирево', 'Отрадное', 'Владыкино', 'Петровско-Разумовская', 'Тимирязевская', 'Дмитровская', 'Савёловская', 'Менделеевская', 'Цветной бульвар', 'Чеховская', 'Боровицкая', 'Полянка', 'Серпуховская', 'Тульская', 'Нагатинская', 'Нагорная', 'Нахимовский проспект', 'Севастопольская', 'Чертановская', 'Южная', 'Пражская', 'Улица академика Янгеля', 'Аннино', 'Бульвар Дмитрия Донского'], 'color': 'abaeba'},
    {'line': 'Люблинско-Дмитровская линия', 'stations': ['Физтех', 'Лианозово', 'Яхромская', 'Селигерская', 'Верхние Лихоборы', 'Окружная', 'Петровско-Разумовская', 'Фонвизинская', 'Бутырская', 'Марьина роща', 'Достоевская', 'Трубная', 'Сретенский бульвар', 'Чкаловская', 'Римская', 'Крестьянская застава', 'Дубровка', 'Кожуховская', 'Печатники', 'Волжская', 'Люблино', 'Братиславская', 'Марьино', 'Борисово', 'Шипиловская', 'Зябликово'], 'color': 'aad16e'},
    {'line': 'Большая кольцевая', 'stations': ['Народное Ополчение', 'Мнёвники', 'Терехово', 'Кунцевская', 'Давыдково', 'Аминьевская', 'Мичуринский проспект', 'Проспект Вернадского', 'Новаторская', 'Воронцовская', 'Зюзино', 'Каховская', 'Варшавская', 'Каширская', 'Кленовый бульвар', 'Нагатинский затон', 'Печатники', 'Текстильщики', 'Нижегородская', 'Авиамоторная', 'Лефортово', 'Электрозаводская', 'Сокольники', 'Рижская', 'Марьина Роща', 'Савёловская', 'Петровский парк', 'ЦСКА', 'Хорошёвская'], 'color': '1cb2a7'},
    {'line': 'Бутовская линия', 'stations': ['Битцевский парк', 'Лесопарковая', 'Улица Старокачаловская', 'Улица Скобелевская', 'Бульвар адмирала Ушакова', 'Улица Горчакова', 'Бунинская аллея'], 'color': '8ec9ea'},
    {'line': 'Московский монорельс', 'stations': [''], 'color': 'd68ab1'},
    {'line': 'Московское центральное кольцо', 'stations': ['Окружная','Владыкино', 'Ботанический сад', 'Ростокино', 'Белокаменная','Бульвар Рокоссовского','Локомотив','Измайлово','Соколиная Гора','Шоссе Энтузиастов','Андроновка','Нижегородская','Новохохловская','Угрешская','Дубровка','Автозаводская','ЗИЛ','Верхние Котлы','Крымская','Площадь Гагарина','Лужники','Кутузовская','Москва-Сити','Шелепиха','Хорошёво','Зорге','Панфиловская','Стрешнево','Балтийская','Коптево','Лихоборы'], 'color': 'd68ab1'},
    {'line': 'Некрасовская линия', 'stations': ['Нижегородская', 'Стахановская', 'Окская', 'Юго-Восточная','Косино','Улица Дмитриевского','Лухмановская','Некрасовка'], 'color': 'd68ab1'},
    {'line': 'Троицкая линия', 'stations': ['Новаторская', ' Университет дружбы народов', 'Генерала Тюленева', 'Тютчевская'], 'color': 'd68ab1'},
    {'line': "Белорусско-Савёловский диаметр", 'stations': ["Одинцово", "Баковка", "Сколково", "Немчиновка", "Сетунь", "Рабочий Посёлок", "Кунцевская", "Славянский бульвар", "Фили", "Москва-Сити", "Беговая", "Белорусская", "Савёловская", "Дмитровская", "Тимирязевская", "Петровско-Разумовская", "Окружная", "Дегунино", "Бескудниково", "Илимская", "Лианозово", "Марк", "Новодачная", "Долгопрудная", "Водники", "Хлебниково", "Шереметьевская", "Лобня"],'color': 'd68ab1'},
    {'line': "Курско-Рижский диаметр", 'stations': ["Подольск", "Силикатная", "Остафьево", "Щербинка", "Бутово", "Новая Битца", "Битца", "Красный Строитель", "Покровское", "Котляково", "Царицыно", "Москворечье", "Курьяново", "Перерва", "Депо", "Люблино", "Печатники", "Текстильщики", "Новохохловская", "Калитники", "Серп и Молот", "Курская", "Площадь трёх вокзалов", "Рижская", "Марьина Роща", "Дмитровская", "Гражданская", "Красный Балтиец","Стрешнево","Тушинская","Трикотажная","Волоколамская","Пенягино","Павшино","Красногорская","Опалиха","Аникеевка","Нахабино"],'color': 'd68ab1'},
    {'line': "Ленинградско-Казанский диаметр",'stations': ["Зеленоград-Крюково", "Малино", "Фирсановская", "Сходня", "Подрезково", "Новоподрезково", "Молжаниново", "Монумент", "Химки", "Левобережная", "Ховрино", "Грачёвская", "Моссельмаш", "Лихоборы", "Петровско-Разумовская", "Останкино", "Рижская", "Митьково", "Электрозаводская", "Сортировочная", "Авиамоторная", "Андроновка", "Перово", "Плющево", "Вешняки", "Выхино", "Косино", "Ухтомская", "Люберцы", "Панки", "Томилино", "Красково", "Малаховка", "Удельная", "Быково", "Ильинская", "Отдых", "Кратово", "Есенинская", "Фабричная", "Раменское", "Ипподром"],'color': '1cb2a7'},
    {'line': "Калужско-Нижегородский диаметр",'stations': ["Апрелевка", "Победа", "Крёкшино", "Санино", "Кокошкино", "Толстопальцево", "Лесной Городок", "Внуково", "Мичуринец", "Переделкино", "Солнечная", "Мещерская", "Очаково", "Аминьевская", "Матвеевская", "Минская", "Поклонная", "Кутузовская", "Москва-Сити", "Ермаковская", "Беговая", "Белорусская", "Савёловская", "Станколит", "Марьина Роща", "Рижская", "Площадь трёх вокзалов", "Курская", "Серп и Молот", "Нижегородская", "Чухлинка", "Кусково", "Новогиреево", "Реутов", "Никольское", "Салтыковская", "Кучино", "Ольгино", "Железнодорожная", "Апрелевка", "Победа", "Крёкшино"],'color': '1cb2a7'},
];

/**
 * Запускает функцию `checkAndRunRar` каждую секунду.
 * Обычно используется для автоперерисовки маршрута или обновления данных.
 */
setInterval(checkAndRunRar, 1000);

/**
 * Удаляет DOM-элементы внутри блока callout.
 * Используется для очистки всплывающих подсказок или окон.
 */
function clear_route() {
    if (document.getElementById("callout"))
    {
        document.querySelector('#callout > div').remove();
        document.querySelector('#callout > header').remove();
        document.querySelector('#callout > button').remove();
        document.querySelector('#callout > div').remove();
        document.querySelector('#callout > div > button').remove();
        document.querySelector('#callout > div > button').remove();
    }
}

/**
 * Пытается найти станцию по текстовому вводу (`searchString`).
 * Если находит точное совпадение — вызывает `handleStationClick`.
 */
function autoCompleteStation() {
    // Найти совпадения с введенной строкой
    let matchedStation = null;
    let searchText = searchString.trim().toLowerCase();

    // Поиск совпадений в списке станций
    metro.forEach(line => {
        line.stations.forEach(station => {
            if (station.toLowerCase() === searchText) {
                matchedStation = station;
            }
        });
    });

    if (matchedStation) {
        handleStationClick(matchedStation); // Автоматически выбрать станцию
    }
}

/**
 * Переключает отображение главного меню.
 * Скрывает клавиатуру, название станции и карту.
 */
function toggleMenu() {
    document.getElementById("keyboard").style.display = "none";
    document.getElementById("Name_station").style.display = "none";
    document.getElementById("pip").style.display = "none";
    var menu = document.getElementById('menu');
    if (menu.style.display === 'none' || menu.style.display === '') {
        document.getElementById("div_open").style.display = "flex";
        document.getElementById("menu").style.display = "none"; // Потом открыть
    } else {
        menu.style.display = 'none';
        document.getElementById("div_open").style.display = "none";
        document.getElementById("menu").style.display = "none";
    }
}

/**
 * Минимально скрывает все элементы интерфейса маршрута.
 */
function creale_mar(){
    document.querySelector("#Name_station").style.display = 'none';
    document.querySelector("#keyboard").style.display = 'none';
    document.querySelector("#menu").style.display = 'none';
    // document.querySelector("#div_open").style.display = 'none';
}

/**
 * Полная очистка маршрута:
 * - удаляет SVG;
 * - сбрасывает стили и названия кнопок;
 * - очищает глобальные массивы;
 * - сбрасывает отображение интерфейса;
 * - обнуляет визуальную карту.
 */
function creale() {
    // Очищаем маршрут и сбрасываем кнопки
    let departure = document.querySelector("#departureBtn")
    let arrival = document.querySelector("#arrivalBtn")
    var g = document.querySelectorAll("svg>g")
    document.querySelector("#pip").innerHTML = '';
    for (let i = 0; i < g.length; i++) {
        g[i].classList.remove('_faded');
        g[i].classList.remove('_highlighted');
    }
    var div = document.getElementById('swap_station');
    div.style.cssText = '';

    blocks.map.clearRoute()
    blocks.fromto.clearSelects()
    myGlobalArrayFromTo = [];
    document.querySelector("#Name_station").style.display = 'none';
    document.querySelector("#keyboard").style.display = 'none';
    document.querySelector("#menu").style.display = 'none';
    document.querySelector("#div_open").style.display = 'none';

    document.querySelector(".clear_routs").style.backgroundImage = 'none';
    document.getElementById("departureImage").style.backgroundColor = "transparent";
    document.getElementById("arrivalImage").style.backgroundColor = "transparent";
    document.getElementById('swap_station').removeAttribute('style');
    document.getElementById("swap_station").style.display = "inline-block";
    document.getElementById("swap_station").style.marginRight  = "10px";
    document.getElementById('departureImage').removeAttribute('style');
    document.getElementById("departureImage").style.display = "inline-block";
    document.getElementById("departureImage").style.marginRight  = "10px";
    document.getElementById('arrivalImage').removeAttribute('style');
    document.getElementById("arrivalImage").style.display = "inline-block";
    document.getElementById("arrivalImage").style.marginRight  = "10px";

    document.getElementById('departureBtn').removeAttribute('style');
    document.getElementById("departureBtn").style.display = "inline-block";
    document.getElementById("departureBtn").style.marginRight  = "10px";
    departure.innerHTML = translateText("Отправление");

    document.getElementById('arrivalBtn').removeAttribute('style');
    document.getElementById("arrivalBtn").style.display = "inline-block";
    document.getElementById("arrivalBtn").style.marginRight  = "10px";
    arrival.innerHTML = translateText("Прибытие на станцию");

    document.getElementById("clear_routs").style.display = "none";

    const mapRouteDiv = document.getElementById('map-route');
    if (mapRouteDiv) {
        const svgElement = mapRouteDiv.querySelector('svg');
        if (svgElement) {
            svgElement.innerHTML = '';
            console.log('Содержимое SVG удалено.');
        } else {
            console.log('SVG внутри map-route не найден.');
        }
    } else {
        console.log('Див с id "map-route" не найден.');
    }
}

// Глобальные переменные
/** @type {HTMLElement|null} */
let activeButton = null; // Кнопка, в которую будет вставляться текст

/** @type {string} */
let searchString = ''; // Переменная для хранения текущей строки поиска


// Потом раскомментировать
// document.getElementById('departureBtn').addEventListener('click', function() {
//     activeButton = 'departure';
//     searchString = '';
//     document.getElementById('div_open').style.display = 'flex';
//     document.getElementById('keyboard').style.display = 'none'; // Потом открыть
//     document.getElementById('Name_station').style.display = 'none'; // Потом открыть
//     document.getElementById('menu').style.display = 'none';
//     document.getElementById('pip').style.display = 'none';
//     if (document.getElementById("Text_img")) {
//         document.getElementById('Text_img').style.display = 'none';
//     }
//     updateStationList('');
// });


// Потом раскомментировать
// document.getElementById('arrivalBtn').addEventListener('click', function() {
//     activeButton = 'arrival';
//     searchString = ''; // Очищаем строку поиска
//     document.getElementById('div_open').style.display = 'flex';
//     document.getElementById('keyboard').style.display = 'none'; // Потом открыть
//     document.getElementById('Name_station').style.display = 'none'; // Потом открыть
//     document.getElementById('menu').style.display = 'none';
//     if (document.getElementById("Text_img")) {
//         document.getElementById('Text_img').style.display = 'none';
//     }
//     updateStationList(''); // Показать все станции
// });

/**
 * Обновляет список станций на экране поиска по фильтру.
 * Показывает только те станции, чьи имена начинаются с введённого текста.
 *
 * @param {string} filter - Текст, введённый пользователем.
 */
function updateStationList(filter) {
    document.getElementById("keyboard").style.display = "none"; // Потом открыть
    document.getElementById("Name_station").style.display = "none"; // Потом открыть
    const nameStationDiv = document.getElementById('Name_station');
    nameStationDiv.innerHTML = '';

    metro.forEach(line => {
        line.stations.forEach(station => {

            const translated = translateText(station);
            if (translated.toLowerCase().startsWith(filter.toLowerCase())) {
                // console.log(station.toLowerCase())
                const stationElem = document.createElement('li');
                stationElem.className = 'station-item';
                stationElem.textContent = translateText(station);
                stationElem.onclick = function() {
                    handleStationClick(translated);
                };
                nameStationDiv.appendChild(stationElem);
            }
        });
    });
}

/**
 * Обрабатывает выбор станции пользователем:
 * - Скрывает интерфейс;
 * - Обновляет текст кнопки "Отправление" или "Прибытие";
 * - Определяет ID выбранной станции по тексту на SVG-карте;
 * - Устанавливает `from` или `to` через blocks.fromto.
 *
 * @param {string} station - Переведённое название станции (из UI).
 */
function handleStationClick(station) {
    document.getElementById("keyboard").style.display = "none"; // Потом открыть
    document.getElementById("Name_station").style.display = "none"; // Потом открыть
    document.getElementById("menu").style.display = "none";

    let h = document.querySelectorAll("svg>g");
    const departureBtn = document.getElementById('departureBtn');
    const arrivalBtn = document.getElementById('arrivalBtn');

    const originalName = getOriginalText(station);  // 🆕 получаем оригинальное имя

    if (activeButton === 'departure') {
        departureBtn.textContent = translateText(originalName); // 🆕 показываем перевод
        departureBtn.dataset.originalName = originalName;       // 🆕 сохраняем оригинал

        for (let i = 0; i < h.length; i++) {
            let textElem = h[i].querySelector("text");
            if (!textElem) continue;

            let translatedName = textElem.textContent.trim();
            let originalStationName = getOriginalText(translatedName);

            let Button_name = originalName.toUpperCase().replace(/\s+/g, '');
            let station_name = originalStationName.toUpperCase().replace(/\s+/g, '');

            if (Button_name === station_name) {
                let id = h[i].id;
                console.log('Departure:', id);
                if (id) {
                    blocks.fromto.setFrom(id);
                }
            }
        }
    } else if (activeButton === 'arrival') {
        arrivalBtn.textContent = translateText(originalName);
        arrivalBtn.dataset.originalName = originalName;

        for (let i = 0; i < h.length; i++) {
            let textElem = h[i].querySelector("text");
            if (!textElem) continue;

            let translatedName = textElem.textContent.trim();
            let originalStationName = getOriginalText(translatedName);

            let Button_name = originalName.toUpperCase().replace(/\s+/g, '');
            let station_name = originalStationName.toUpperCase().replace(/\s+/g, '');

            if (Button_name === station_name) {
                let id = h[i].id;
                console.log('Arrival:', id);
                if (id) {
                    blocks.fromto.setTo(id);
                }
            }
        }
    }

    document.getElementById('div_open').style.display = 'none';
}


/**
 * Добавляет обработчики клика на все кнопки с классом "key" (виртуальная клавиатура).
 * По нажатию обновляет строку поиска, обновляет список станций и тексты на кнопках.
 */
document.querySelectorAll('.key').forEach(key => {
    key.addEventListener('click', function() {
        const keyValue = key.textContent.trim();
        if (keyValue === '_') {
            searchString += ' ';
        } else if (keyValue === '⌫') {
            searchString = searchString.slice(0, -1);
        } else {
            searchString += keyValue;
        }
        updateStationList(searchString);
        updateActiveButtonText(searchString);
        autoCompleteStation();
    });
});

/**
 * Отображает список станций выбранной линии метро.
 *
 * @param {number} lineIndex - Индекс линии метро в массиве `metro`.
 */
function showLineStations(lineIndex) {
    console.log(lineIndex)
    // Находим существующий ul, если он есть, и удаляем его
    var existingUl = document.getElementById('Text_img');
    if (existingUl) {
        existingUl.remove();
    }

    // Создаем новый ul элемент и задаем ему id
    var ul = document.createElement('ul');
    ul.setAttribute('id', 'Text_img');

    // Получаем список станций из массива метро по индексу линии
    var productList = metro[lineIndex].stations;
    console.log(metro[lineIndex].stations)

    // Добавляем новый ul элемент в контейнер
    document.getElementById('container').appendChild(ul);

    // Проходим по списку станций и создаем li элементы для каждой станции
    productList.forEach(function(element) {
        var li = document.createElement('li');
        li.setAttribute('class', 'item_img');
        li.setAttribute('onclick', 'Text_station_img(this)');
        li.innerHTML = translateText(element);
        ul.appendChild(li);
    });

    // Делаем видимыми элементы клавиатуры и списка станций
    document.getElementById("keyboard").style.display = "none";
    document.getElementById("Name_station").style.display = "none";
    document.getElementById("Text_img").style.display = "none"; // Потом открыть
}

/**
 * Обновляет текст на активной кнопке выбора станции (отправление или прибытие).
 *
 * @param {string} text - Текст для отображения.
 */
function updateActiveButtonText(text) {
    if (activeButton === 'departure') {
        document.getElementById('departureBtn').textContent = translateText(text);
    } else if (activeButton === 'arrival') {
        document.getElementById('arrivalBtn').textContent = translateText(text);

    }
}

/**
 * Таймер неактивности — по истечении 2 минут без действий страница перезагружается.
 * Сброс таймера происходит по событиям касания и скролла.
 */
let inactivityTimeout;

function resetInactivityTimer() {
    clearTimeout(inactivityTimeout);
    inactivityTimeout = setTimeout(() => {
        location.reload();
    }, 2 * 60 * 1000);
}

// Список событий, по которым будет сбрасываться таймер неактивности
['touchstart', 'touchmove', 'touchend', 'touchcancel', 'scroll'].forEach(evt => {
    document.addEventListener(evt, resetInactivityTimer, true);
});

// Запускаем таймер при загрузке страницы
resetInactivityTimer();

</script>

        <div class="map__zoom">
            <div class="zoom">
                <div class="zoom__in"></div>
                <div class="zoom__out"></div>
            </div>
        </div>


    <div class="callout" id="callout"></div>
    <script src="/map/js/app.js?v20.0"></script>
</body>
</html>
